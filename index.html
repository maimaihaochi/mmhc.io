<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>四时巡游·神话视觉转化系统</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            transition: background-color 0.5s ease, border-color 0.5s ease, color 0.5s ease, transform 0.5s ease, opacity 0.5s ease;
        }
        
        body {
            background-color: #0a0e17;
            color: #e8f4f8;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        /* 全屏背景动画 */
        .fullscreen-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            pointer-events: none;
            opacity: 0.2;
            background: 
                radial-gradient(circle at 20% 30%, var(--theme-color) 0%, transparent 70%),
                radial-gradient(circle at 80% 70%, var(--theme-secondary) 0%, transparent 70%);
            filter: blur(60px);
            transition: opacity 1s ease;
        }
        
        /* 星空背景 */
        .star-field {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -3;
            pointer-events: none;
        }
        
        .star {
            position: absolute;
            background-color: white;
            border-radius: 50%;
            opacity: 0;
            animation: twinkle var(--twinkle-duration) infinite ease-in-out;
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.2; }
            50% { opacity: 0.8; }
        }
        
        /* 主题背景渐变和风景元素 */
        .theme-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
            opacity: 0.25;
            transition: opacity 0.8s ease;
            mix-blend-mode: overlay;
        }
        
        .theme-gradient {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.4;
            transition: opacity 0.8s ease;
            background: radial-gradient(circle at 30% 20%, var(--theme-color-light) 0%, transparent 50%),
                       radial-gradient(circle at 70% 80%, var(--theme-color-light) 0%, transparent 50%);
        }
        
        .landscape-elements {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.15;
        }
        
        .spring-landscape {
            background: 
                linear-gradient(60deg, transparent 65%, #2ecc71 70%, transparent 75%) 0% 20% / 30% 60% repeat-y,
                linear-gradient(120deg, transparent 65%, #27ae60 70%, transparent 75%) 70% 30% / 25% 50% repeat-y,
                radial-gradient(ellipse at 40% 70%, rgba(46, 204, 113, 0.2) 0%, transparent 50%);
            animation: float 20s infinite ease-in-out;
        }
        
        .summer-landscape {
            background: 
                radial-gradient(circle at 20% 30%, #e74c3c 0%, transparent 50%),
                radial-gradient(circle at 80% 60%, #c0392b 0%, transparent 50%),
                linear-gradient(45deg, transparent 60%, rgba(231, 76, 60, 0.3) 65%, transparent 70%) 0% 40% / 40% 40% repeat;
            animation: flicker 3s infinite alternate;
        }
        
        .autumn-landscape {
            background: 
                linear-gradient(30deg, transparent 60%, #f39c12 65%, transparent 70%) 10% 30% / 35% 50% repeat-y,
                linear-gradient(150deg, transparent 60%, #d35400 65%, transparent 70%) 80% 40% / 30% 40% repeat-y,
                radial-gradient(ellipse at 60% 40%, rgba(243, 156, 18, 0.2) 0%, transparent 60%);
            animation: sway 25s infinite ease-in-out;
        }
        
        .winter-landscape {
            background: 
                radial-gradient(circle at 30% 40%, rgba(52, 152, 219, 0.3) 0%, transparent 60%),
                radial-gradient(circle at 70% 20%, rgba(41, 128, 185, 0.3) 0%, transparent 60%),
                linear-gradient(0deg, transparent 70%, rgba(255, 255, 255, 0.1) 75%, transparent 80%) 0% 50% / 100% 20% repeat;
            animation: snow-drift 30s infinite linear;
        }
        
        .all-landscape {
            background: 
                radial-gradient(circle at 20% 30%, #9b59b6 0%, transparent 50%),
                radial-gradient(circle at 80% 60%, #8e44ad 0%, transparent 50%),
                linear-gradient(45deg, transparent 70%, rgba(155, 89, 182, 0.3) 75%, transparent 80%) 0% 30% / 50% 40% repeat,
                radial-gradient(ellipse at 50% 50%, rgba(155, 89, 182, 0.1) 0%, transparent 70%);
            animation: rotate 60s infinite linear;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-20px) scale(1.02); }
        }
        
        @keyframes flicker {
            0%, 100% { opacity: 0.15; }
            50% { opacity: 0.25; }
        }
        
        @keyframes sway {
            0%, 100% { transform: skewY(0deg); }
            50% { transform: skewY(1deg); }
        }
        
        @keyframes snow-drift {
            0% { background-position: 0% 0%, 0% 0%, 0% 50%; }
            100% { background-position: 0% 0%, 0% 0%, 0% 150%; }
        }
        
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* 装饰性元素 */
        .seasonal-decoration {
            position: fixed;
            pointer-events: none;
            z-index: -1;
            transition: opacity 1s ease;
        }
        
        .decoration-spring {
            top: 10%;
            right: 5%;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(46, 204, 113, 0.1) 0%, transparent 70%);
            border-radius: 50%;
            filter: blur(20px);
            animation: pulse 8s infinite ease-in-out;
        }
        
        .decoration-summer {
            top: 15%;
            left: 5%;
            width: 150px;
            height: 150px;
            background: radial-gradient(circle, rgba(231, 76, 60, 0.15) 0%, transparent 70%);
            border-radius: 50%;
            filter: blur(15px);
            animation: flame 4s infinite alternate;
        }
        
        .decoration-autumn {
            bottom: 10%;
            left: 10%;
            width: 180px;
            height: 180px;
            background: radial-gradient(ellipse, rgba(243, 156, 18, 0.1) 0%, transparent 70%);
            filter: blur(25px);
            animation: fall 12s infinite ease-in-out;
        }
        
        .decoration-winter {
            bottom: 15%;
            right: 10%;
            width: 220px;
            height: 220px;
            background: radial-gradient(circle, rgba(52, 152, 219, 0.1) 0%, transparent 70%);
            border-radius: 50%;
            filter: blur(30px);
            animation: drift 20s infinite linear;
        }
        
        .decoration-all {
            top: 50%;
            left: 50%;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(155, 89, 182, 0.05) 0%, transparent 70%);
            border-radius: 50%;
            filter: blur(40px);
            transform: translate(-50%, -50%);
            animation: rotate-slow 40s infinite linear;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.3; }
            50% { transform: scale(1.2); opacity: 0.5; }
        }
        
        @keyframes flame {
            0%, 100% { transform: scale(1) translateY(0); opacity: 0.3; }
            50% { transform: scale(1.1) translateY(-20px); opacity: 0.5; }
        }
        
        @keyframes fall {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(30px) rotate(180deg); }
        }
        
        @keyframes drift {
            0% { transform: translateX(0) translateY(0); }
            25% { transform: translateX(20px) translateY(-30px); }
            50% { transform: translateX(0) translateY(-60px); }
            75% { transform: translateX(-20px) translateY(-30px); }
            100% { transform: translateX(0) translateY(0); }
        }
        
        @keyframes rotate-slow {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }
        
        /* 开场动画 */
        .intro-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0a0e17 0%, #1a2530 100%);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            animation: fadeOut 1s ease 3s forwards;
        }
        
        .intro-title {
            font-size: 3.5rem;
            background: linear-gradient(90deg, #4db8ff, #2ecc71, #e74c3c, #f39c12);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 20px;
            text-align: center;
            opacity: 0;
            animation: fadeInUp 1s ease 0.5s forwards;
            font-weight: 700;
            letter-spacing: 1px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }
        
        .intro-subtitle {
            font-size: 1.2rem;
            color: #8aadcc;
            margin-bottom: 40px;
            letter-spacing: 4px;
            opacity: 0;
            animation: fadeInUp 1s ease 1s forwards;
            font-weight: 400;
            text-shadow: 0 1px 5px rgba(0, 0, 0, 0.3);
        }
        
        .season-sequence {
            display: flex;
            gap: 20px;
            margin-top: 40px;
        }
        
        .season-dot {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            opacity: 0;
            transform: scale(0);
        }
        
        .season-dot.spring { background: #2ecc71; animation: pulseDot 0.5s ease 1.5s forwards; }
        .season-dot.summer { background: #e74c3c; animation: pulseDot 0.5s ease 1.7s forwards; }
        .season-dot.autumn { background: #f39c12; animation: pulseDot 0.5s ease 1.9s forwards; }
        .season-dot.winter { background: #3498db; animation: pulseDot 0.5s ease 2.1s forwards; }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes fadeOut {
            to { opacity: 0; visibility: hidden; }
        }
        
        @keyframes pulseDot {
            0% { opacity: 0; transform: scale(0); }
            50% { opacity: 1; transform: scale(1.2); }
            100% { opacity: 1; transform: scale(1); }
        }
        
        .container {
            display: flex;
            min-height: 100vh;
            position: relative;
            z-index: 2;
            opacity: 0;
            animation: fadeIn 1s ease 3.5s forwards;
        }
        
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        /* 粒子画布 */
        #particles-canvas {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
            transition: opacity 0.5s ease;
            mix-blend-mode: screen;
        }
        
        /* 左侧导航和信息面板 */
        .left-panel {
            width: 320px;
            background: linear-gradient(135deg, rgba(17, 26, 42, 0.85) 0%, rgba(10, 14, 23, 0.85) 100%);
            padding: 25px 20px;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            overflow-y: auto;
            box-shadow: 5px 0 25px rgba(0, 10, 30, 0.7);
            z-index: 10;
            position: relative;
            backdrop-filter: blur(15px);
            transform: translateX(0);
            transition: transform 0.5s ease, background 0.5s ease;
        }
        
        .left-panel:hover {
            background: linear-gradient(135deg, rgba(20, 30, 48, 0.9) 0%, rgba(12, 18, 28, 0.9) 100%);
        }
        
        .logo {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }
        
        .logo h1 {
            font-size: 22px;
            background: linear-gradient(90deg, #4db8ff, var(--theme-color));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 5px;
            transition: all 0.5s ease;
            position: relative;
            display: inline-block;
            font-weight: 700;
            letter-spacing: 0.5px;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        
        .logo h1::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--theme-color);
            transition: width 0.5s ease;
        }
        
        .logo:hover h1::after {
            width: 100%;
        }
        
        .logo p {
            font-size: 13px;
            color: #8aadcc;
            letter-spacing: 2px;
            opacity: 0.8;
            font-weight: 400;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }
        
        .season-nav {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 30px;
        }
        
        .season-btn {
            padding: 14px 18px;
            border: none;
            border-radius: 10px;
            background: rgba(20, 35, 60, 0.6);
            color: #cce0ff;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            font-weight: 500;
        }
        
        .season-btn::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 0;
            background: var(--theme-color);
            transition: width 0.3s ease;
            opacity: 0.2;
        }
        
        .season-btn:hover::before {
            width: 100%;
        }
        
        .season-btn.active {
            background: rgba(30, 50, 80, 0.9);
            transform: translateX(5px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
            border-color: var(--theme-color);
        }
        
        .season-btn.active::before {
            width: 6px;
            background: var(--theme-color);
        }
        
        .season-icon {
            font-size: 18px;
            transition: transform 0.3s ease;
        }
        
        .season-btn:hover .season-icon {
            transform: scale(1.2) rotate(10deg);
        }
        
        .god-info {
            background: rgba(15, 30, 50, 0.6);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: none;
            animation: fadeIn 0.5s ease;
            transition: all 0.5s ease;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        
        .god-info.active {
            display: block;
            animation: slideIn 0.5s ease;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .god-name {
            font-size: 22px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: color 0.5s ease;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            font-weight: 700;
            letter-spacing: 0.5px;
        }
        
        .god-season {
            font-size: 14px;
            color: #8aadcc;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-weight: 500;
        }
        
        .keywords {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .keyword {
            background: var(--theme-color-light);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 13px;
            transition: all 0.5s ease;
            border: 1px solid var(--theme-color-medium);
            backdrop-filter: blur(5px);
            font-weight: 500;
        }
        
        .keyword:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px var(--theme-color-light);
        }
        
        .info-section {
            margin-bottom: 15px;
        }
        
        .info-section h4 {
            color: var(--theme-color);
            margin-bottom: 8px;
            font-size: 15px;
            border-bottom: 1px solid var(--theme-color-medium);
            padding-bottom: 5px;
            font-weight: 600;
        }
        
        .info-section p {
            font-size: 14px;
            line-height: 1.5;
            font-weight: 400;
        }
        
        /* 中间主展示区 */
        .main-display {
            flex: 1;
            padding: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            background: rgba(10, 14, 23, 0.6);
            transition: background-color 0.5s ease;
            backdrop-filter: blur(5px);
        }
        
        .display-title {
            font-size: 28px;
            margin-bottom: 20px;
            text-align: center;
            background: linear-gradient(90deg, var(--theme-color), var(--theme-secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            transition: all 0.5s ease;
            text-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            position: relative;
            padding-bottom: 10px;
            font-weight: 700;
            letter-spacing: 0.5px;
        }
        
        .display-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 25%;
            width: 50%;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--theme-color), transparent);
            border-radius: 3px;
        }
        
        .main-image-container {
            width: 90%;
            max-width: 900px;
            height: 550px;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.6);
            margin-bottom: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: linear-gradient(135deg, rgba(17, 26, 42, 0.8) 0%, rgba(10, 14, 23, 0.8) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.5s ease;
            backdrop-filter: blur(10px);
            transform-style: preserve-3d;
            perspective: 1000px;
        }
        
        .main-image-container::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, var(--theme-color), var(--theme-secondary), var(--theme-color));
            border-radius: 22px;
            z-index: -1;
            opacity: 0.3;
            filter: blur(10px);
        }
        
        .main-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            background-color: rgba(13, 21, 34, 0.7);
            transition: transform 0.3s ease;
            cursor: grab;
            max-width: 100%;
            max-height: 100%;
            user-select: none;
            border-radius: 15px;
        }
        
        .main-image:active {
            cursor: grabbing;
        }
        
        .main-image:hover {
            transform: scale(1.02);
        }
        
        .image-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #6a8baa;
            font-size: 18px;
            text-align: center;
            padding: 20px;
            font-weight: 500;
        }
        
        .image-placeholder i {
            font-size: 80px;
            margin-bottom: 20px;
            opacity: 0.3;
            animation: float 3s infinite ease-in-out;
        }
        
        .zoom-controls {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 5;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.5s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .zoom-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: none;
            background: linear-gradient(135deg, var(--theme-color), var(--theme-color-dark));
            color: white;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .zoom-btn:hover {
            transform: scale(1.1) translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }
        
        .zoom-btn:active {
            transform: scale(0.95);
        }
        
        .zoom-btn.reset {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
            font-size: 16px;
        }
        
        .zoom-btn.reset:hover {
            background: linear-gradient(135deg, #7f8c8d, #6c7b7c);
        }
        
        .zoom-level {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 18px;
            border-radius: 25px;
            font-size: 14px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 5;
            transition: all 0.5s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            font-weight: 500;
        }
        
        .image-info {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 15px 25px;
            border-radius: 15px;
            max-width: 60%;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 5;
            transition: all 0.5s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .image-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--theme-color);
            transition: color 0.5s ease;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        
        .image-description {
            font-size: 14px;
            opacity: 0.9;
            font-weight: 400;
        }
        
        /* 可自定义介绍栏 */
        .custom-description-container {
            width: 90%;
            max-width: 900px;
            margin-top: 15px;
            margin-bottom: 25px;
            background: rgba(15, 30, 50, 0.7);
            border-radius: 12px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
            transition: all 0.5s ease;
        }
        
        .custom-description-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 10px;
        }
        
        .custom-description-title {
            font-size: 18px;
            color: var(--theme-color);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .description-controls {
            display: flex;
            gap: 10px;
        }
        
        .description-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 8px;
            color: #e8f4f8;
            font-size: 13px;
            padding: 6px 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .description-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }
        
        .custom-description-content {
            min-height: 80px;
            font-size: 14px;
            line-height: 1.6;
            color: #cce0ff;
            padding: 10px;
            background: rgba(20, 35, 60, 0.4);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            font-weight: 400;
        }
        
        .custom-description-edit {
            display: none;
            width: 100%;
            min-height: 80px;
            padding: 12px;
            background: rgba(20, 35, 60, 0.8);
            border: 1px solid var(--theme-color);
            border-radius: 8px;
            color: #e8f4f8;
            font-size: 14px;
            line-height: 1.5;
            resize: vertical;
            font-family: inherit;
            margin-bottom: 10px;
        }
        
        .custom-description-edit:focus {
            outline: none;
            box-shadow: 0 0 0 3px var(--theme-color-light);
        }
        
        .custom-description-placeholder {
            color: #6a8baa;
            font-style: italic;
            text-align: center;
            padding: 20px;
            opacity: 0.7;
        }
        
        .main-controls {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }
        
        .control-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 12px;
            background: linear-gradient(135deg, #2c3e50, #1a2530);
            color: #e8f4f8;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            font-weight: 500;
        }
        
        .control-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        
        .control-btn:active {
            transform: translateY(-2px);
        }
        
        .control-btn.remove {
            background: linear-gradient(135deg, #c0392b, #e74c3c);
        }
        
        /* 主展示区装饰边框 */
        .display-frame {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
            border-radius: 20px;
        }
        
        .frame-corner {
            position: absolute;
            width: 40px;
            height: 40px;
        }
        
        .frame-corner.tl { top: 10px; left: 10px; border-top: 2px solid var(--theme-color); border-left: 2px solid var(--theme-color); }
        .frame-corner.tr { top: 10px; right: 10px; border-top: 2px solid var(--theme-color); border-right: 2px solid var(--theme-color); }
        .frame-corner.bl { bottom: 10px; left: 10px; border-bottom: 2px solid var(--theme-color); border-left: 2px solid var(--theme-color); }
        .frame-corner.br { bottom: 10px; right: 10px; border-bottom: 2px solid var(--theme-color); border-right: 2px solid var(--theme-color); }
        
        /* 右侧图片面板 */
        .right-panel {
            width: 380px;
            background: linear-gradient(135deg, rgba(17, 26, 42, 0.85) 0%, rgba(10, 14, 23, 0.85) 100%);
            padding: 25px 15px;
            border-left: 1px solid rgba(255, 255, 255, 0.1);
            overflow-y: auto;
            box-shadow: -5px 0 25px rgba(0, 10, 30, 0.7);
            z-index: 10;
            position: relative;
            backdrop-filter: blur(15px);
            transform: translateX(0);
            transition: transform 0.5s ease, background 0.5s ease;
        }
        
        .right-panel:hover {
            background: linear-gradient(135deg, rgba(20, 30, 48, 0.9) 0%, rgba(12, 18, 28, 0.9) 100%);
        }
        
        .panel-title {
            font-size: 18px;
            margin-bottom: 20px;
            color: var(--theme-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: color 0.5s ease;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-weight: 600;
        }
        
        .panel-title span {
            font-size: 14px;
            color: #8aadcc;
            font-weight: 500;
        }
        
        .upload-section {
            background: rgba(15, 30, 50, 0.5);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.5s ease;
            backdrop-filter: blur(5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        
        .upload-title {
            font-size: 16px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--theme-color);
            font-weight: 600;
        }
        
        .upload-controls {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 15px;
        }
        
        .upload-btn {
            padding: 12px;
            background: linear-gradient(135deg, var(--theme-color), var(--theme-color-dark));
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(5px);
            font-weight: 500;
        }
        
        .upload-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        
        .upload-btn:active {
            transform: translateY(-1px);
        }
        
        .upload-btn.full {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
        }
        
        .upload-btn.add-new {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
        }
        
        .upload-btn.import-folder {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }
        
        .upload-btn.full:hover {
            background: linear-gradient(135deg, #8e44ad, #71368a);
        }
        
        .upload-area {
            border: 2px dashed rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 15px;
            display: none;
            backdrop-filter: blur(5px);
            background: rgba(30, 45, 70, 0.3);
        }
        
        .upload-area.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .upload-area:hover {
            border-color: var(--theme-color);
            background: rgba(30, 60, 90, 0.4);
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        
        .upload-area i {
            font-size: 48px;
            color: var(--theme-color);
            margin-bottom: 15px;
            opacity: 0.8;
        }
        
        .upload-area p {
            margin: 8px 0;
            font-size: 14px;
        }
        
        .upload-area .file-count {
            font-size: 12px;
            color: #8aadcc;
            margin-top: 10px;
        }
        
        .upload-input {
            display: none;
        }
        
        .upload-form {
            display: none;
            flex-direction: column;
            gap: 12px;
            margin-top: 15px;
            padding: 20px;
            background: rgba(20, 35, 60, 0.5);
            border-radius: 12px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: slideIn 0.3s ease;
        }
        
        .upload-form.active {
            display: flex;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .form-label {
            font-size: 14px;
            color: #8aadcc;
            font-weight: 500;
        }
        
        .form-input, .form-select {
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(30, 45, 70, 0.8);
            color: #e8f4f8;
            font-size: 14px;
            transition: all 0.3s ease;
            font-weight: 400;
        }
        
        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--theme-color);
            box-shadow: 0 0 0 3px var(--theme-color-light);
        }
        
        .form-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .form-btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            font-weight: 500;
        }
        
        .form-btn.confirm {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
        }
        
        .form-btn.cancel {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
        }
        
        .form-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        
        .form-btn:active {
            transform: translateY(0);
        }
        
        .upload-info {
            font-size: 12px;
            color: #8aadcc;
            margin-top: 15px;
            text-align: center;
            opacity: 0.7;
            font-weight: 400;
        }
        
        /* 文件夹导入样式 */
        .folder-import-container {
            display: none;
            margin-top: 15px;
            background: rgba(20, 35, 60, 0.5);
            border-radius: 12px;
            padding: 20px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .folder-import-container.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .folder-structure {
            margin-top: 15px;
            padding: 15px;
            background: rgba(30, 45, 70, 0.3);
            border-radius: 8px;
            max-height: 300px;
            overflow-y: auto;
            display: none;
        }
        
        .folder-item {
            padding: 8px 12px;
            margin: 5px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .folder-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }
        
        .folder-item i {
            color: var(--theme-color);
            font-size: 16px;
        }
        
        .folder-item.selected {
            background: rgba(52, 152, 219, 0.2);
            border-left: 3px solid var(--theme-color);
        }
        
        .folder-info {
            flex: 1;
        }
        
        .folder-name {
            font-size: 14px;
            font-weight: 500;
        }
        
        .folder-count {
            font-size: 11px;
            color: #8aadcc;
        }
        
        /* 文件预览区域 */
        .file-preview-container {
            display: none;
            margin-top: 15px;
            background: rgba(20, 35, 60, 0.5);
            border-radius: 12px;
            padding: 15px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .file-preview-container.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .preview-title {
            font-size: 14px;
            color: var(--theme-color);
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .preview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
            max-height: 200px;
            overflow-y: auto;
            padding: 10px;
            background: rgba(30, 45, 70, 0.3);
            border-radius: 8px;
        }
        
        .preview-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            height: 80px;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .preview-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .preview-name {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            font-size: 10px;
            padding: 4px;
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .preview-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            display: none;
        }
        
        /* 上传进度指示器 */
        .upload-progress {
            display: none;
            background: rgba(20, 35, 60, 0.8);
            border-radius: 12px;
            padding: 20px;
            margin-top: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .upload-progress.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .progress-title {
            font-size: 14px;
            color: var(--theme-color);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
        }
        
        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--theme-color), var(--theme-color-dark));
            border-radius: 4px;
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .progress-text {
            font-size: 12px;
            color: #8aadcc;
            text-align: center;
            font-weight: 400;
        }
        
        /* 上传成功提示 */
        .upload-success {
            display: none;
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.2), transparent);
            border: 1px solid rgba(46, 204, 113, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-top: 15px;
            text-align: center;
            backdrop-filter: blur(10px);
        }
        
        .upload-success.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .success-icon {
            font-size: 40px;
            color: #2ecc71;
            margin-bottom: 10px;
        }
        
        .success-text {
            font-size: 14px;
            color: #e8f4f8;
            font-weight: 500;
        }
        
        .success-details {
            font-size: 12px;
            color: #8aadcc;
            margin-top: 8px;
        }
        
        /* 文件类型标签 */
        .file-type-tag {
            display: inline-block;
            padding: 3px 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            font-size: 11px;
            color: #8aadcc;
            margin: 2px;
        }
        
        .supported-formats {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            justify-content: center;
            margin-top: 10px;
        }
        
        /* 图片库样式 */
        .image-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 15px;
            max-height: 500px;
            overflow-y: auto;
            padding-right: 5px;
        }
        
        .gallery-item {
            position: relative;
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            height: 150px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(5px);
            background: rgba(20, 35, 60, 0.4);
        }
        
        .gallery-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255,255,255,0.1), transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .gallery-item:hover {
            transform: translateY(-5px) scale(1.02);
            border-color: var(--theme-color);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }
        
        .gallery-item:hover::before {
            opacity: 1;
        }
        
        .gallery-item.active {
            box-shadow: 0 0 25px var(--theme-color-medium);
            transform: translateY(-5px);
            border-color: var(--theme-color);
        }
        
        .gallery-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .gallery-item:hover .gallery-image {
            transform: scale(1.1);
        }
        
        .gallery-label {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.9));
            padding: 10px;
            font-size: 13px;
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-weight: 500;
        }
        
        .gallery-controls {
            position: absolute;
            top: 8px;
            right: 8px;
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .gallery-item:hover .gallery-controls {
            opacity: 1;
        }
        
        .gallery-control-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }
        
        .gallery-control-btn:hover {
            transform: scale(1.1);
        }
        
        .gallery-control-btn.rename {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }
        
        .gallery-control-btn.replace {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
        }
        
        .gallery-control-btn.delete {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }
        
        .empty-message {
            text-align: center;
            color: #6a8baa;
            padding: 30px 10px;
            font-style: italic;
            opacity: 0.7;
            font-weight: 400;
        }
        
        .season-indicators {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 25px;
        }
        
        .season-indicator {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .season-indicator::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255,255,255,0.2), transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .season-indicator:hover::before {
            opacity: 1;
        }
        
        .season-indicator.spring { background: linear-gradient(135deg, #2ecc71, #27ae60); }
        .season-indicator.summer { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        .season-indicator.autumn { background: linear-gradient(135deg, #f39c12, #d35400); }
        .season-indicator.winter { background: linear-gradient(135deg, #3498db, #2980b9); }
        
        .season-indicator:hover {
            transform: scale(1.1) translateY(-5px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.4);
        }
        
        .season-indicator.active {
            transform: scale(1.2);
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.3);
        }
        
        /* 可隐藏式底部导航栏 */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(10, 14, 23, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding: 12px 0;
            z-index: 100;
            display: flex;
            justify-content: center;
            gap: 30px;
            transform: translateY(0);
            transition: transform 0.5s ease, opacity 0.5s ease;
            box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.5);
        }
        
        .bottom-nav.hidden {
            transform: translateY(100%);
            opacity: 0;
            pointer-events: none;
        }
        
        .bottom-nav-toggle {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 30px;
            background: rgba(10, 14, 23, 0.9);
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-bottom: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 101;
            transition: all 0.3s ease;
            box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .bottom-nav-toggle:hover {
            background: rgba(20, 30, 48, 0.9);
            transform: translateX(-50%) translateY(-5px);
        }
        
        .bottom-nav-toggle i {
            color: var(--theme-color);
            font-size: 16px;
            transition: transform 0.3s ease;
        }
        
        .bottom-nav-toggle:hover i {
            transform: translateY(-2px);
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            color: #8aadcc;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 10px 15px;
            border-radius: 10px;
        }
        
        .nav-item:hover {
            color: var(--theme-color);
            background: rgba(255, 255, 255, 0.05);
            transform: translateY(-5px);
        }
        
        .nav-item i {
            font-size: 20px;
        }
        
        .nav-item span {
            font-size: 12px;
            font-weight: 500;
        }
        
        /* 季节主题颜色类 */
        .theme-spring {
            --theme-color: #2ecc71;
            --theme-secondary: #27ae60;
            --theme-color-light: rgba(46, 204, 113, 0.2);
            --theme-color-medium: rgba(46, 204, 113, 0.5);
            --theme-color-dark: #27ae60;
        }
        
        .theme-summer {
            --theme-color: #e74c3c;
            --theme-secondary: #c0392b;
            --theme-color-light: rgba(231, 76, 60, 0.2);
            --theme-color-medium: rgba(231, 76, 60, 0.5);
            --theme-color-dark: #c0392b;
        }
        
        .theme-autumn {
            --theme-color: #f39c12;
            --theme-secondary: #d35400;
            --theme-color-light: rgba(243, 156, 18, 0.2);
            --theme-color-medium: rgba(243, 156, 18, 0.5);
            --theme-color-dark: #d35400;
        }
        
        .theme-winter {
            --theme-color: #3498db;
            --theme-secondary: #2980b9;
            --theme-color-light: rgba(52, 152, 219, 0.2);
            --theme-color-medium: rgba(52, 152, 219, 0.5);
            --theme-color-dark: #2980b9;
        }
        
        .theme-all {
            --theme-color: #9b59b6;
            --theme-secondary: #8e44ad;
            --theme-color-light: rgba(155, 89, 182, 0.2);
            --theme-color-medium: rgba(155, 89, 182, 0.5);
            --theme-color-dark: #8e44ad;
        }
        
        /* 季节切换动画 */
        .season-transition-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 999;
            pointer-events: none;
            opacity: 0;
            background: var(--theme-color);
            mix-blend-mode: overlay;
            transition: opacity 0.5s ease;
        }
        
        /* 滚动条美化 */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(20, 35, 60, 0.3);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--theme-color);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--theme-color-dark);
        }
        
        /* 响应式增强 */
        @media (max-width: 1200px) {
            .container {
                flex-direction: column;
            }
            
            .left-panel, .right-panel {
                width: 100%;
                border-right: none;
                border-left: none;
                transform: none !important;
            }
            
            .left-panel {
                border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            }
            
            .right-panel {
                border-top: 1px solid rgba(255, 255, 255, 0.1);
            }
            
            .season-nav {
                flex-direction: row;
                flex-wrap: wrap;
            }
            
            .season-btn {
                flex: 1;
                min-width: 150px;
            }
            
            #particles-canvas {
                height: 30%;
            }
            
            .bottom-nav {
                gap: 15px;
            }
        }
        
        @media (max-width: 768px) {
            .intro-title {
                font-size: 2rem;
            }
            
            .main-display {
                padding: 20px 15px;
            }
            
            .main-image-container {
                width: 100%;
                height: 400px;
            }
            
            .display-title {
                font-size: 22px;
            }
            
            .control-btn {
                padding: 10px 20px;
                font-size: 13px;
            }
            
            .image-gallery {
                grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
            }
            
            .gallery-item {
                height: 130px;
            }
            
            .zoom-controls {
                bottom: 10px;
                right: 10px;
            }
            
            .zoom-btn {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
            
            .image-info {
                bottom: 10px;
                left: 10px;
                max-width: 70%;
                padding: 12px 18px;
            }
            
            #particles-canvas {
                height: 25%;
            }
            
            .bottom-nav {
                gap: 10px;
                padding: 10px 0;
            }
            
            .nav-item {
                padding: 8px 12px;
            }
            
            .nav-item i {
                font-size: 18px;
            }
            
            .nav-item span {
                font-size: 10px;
            }
            
            .bottom-nav-toggle {
                width: 60px;
                height: 25px;
            }
        }
    </style>
</head>
<body>
    <!-- 开场动画 -->
    <div class="intro-overlay" id="intro-overlay">
        <div class="intro-title">四时巡游·神话视觉转化系统</div>
        <div class="intro-subtitle">时序之神 · 系统化视觉转译工程</div>
        <div class="season-sequence">
            <div class="season-dot spring"></div>
            <div class="season-dot summer"></div>
            <div class="season-dot autumn"></div>
            <div class="season-dot winter"></div>
        </div>
    </div>
    
    <!-- 全屏背景 -->
    <div class="fullscreen-background" id="fullscreen-background"></div>
    
    <!-- 星空背景 -->
    <div class="star-field" id="star-field"></div>
    
    <!-- 主题背景 -->
    <div class="theme-background" id="theme-background">
        <div class="theme-gradient" id="theme-gradient"></div>
        <div class="landscape-elements" id="landscape-elements"></div>
    </div>
    
    <!-- 季节装饰元素 -->
    <div class="seasonal-decoration decoration-spring" id="decoration-spring" style="opacity: 0;"></div>
    <div class="seasonal-decoration decoration-summer" id="decoration-summer" style="opacity: 0;"></div>
    <div class="seasonal-decoration decoration-autumn" id="decoration-autumn" style="opacity: 0;"></div>
    <div class="seasonal-decoration decoration-winter" id="decoration-winter" style="opacity: 0;"></div>
    <div class="seasonal-decoration decoration-all" id="decoration-all" style="opacity: 0;"></div>
    
    <!-- 季节切换遮罩 -->
    <div class="season-transition-overlay" id="season-transition-overlay"></div>
    
    <!-- 粒子效果画布 -->
    <canvas id="particles-canvas"></canvas>
    
    <div class="container">
        <!-- 左侧导航和信息面板 -->
        <div class="left-panel">
            <div class="logo">
                <h1 id="main-logo">四时巡游·神话视觉转化系统</h1>
                <p>时序之神·系统化视觉转译工程</p>
            </div>
            
            <div class="season-nav">
                <button class="season-btn spring active" data-season="spring">
                    <i class="fas fa-seedling season-icon"></i>
                    <span>句芒 · 春神</span>
                </button>
                <button class="season-btn summer" data-season="summer">
                    <i class="fas fa-fire season-icon"></i>
                    <span>祝融 · 夏神</span>
                </button>
                <button class="season-btn autumn" data-season="autumn">
                    <i class="fas fa-leaf season-icon"></i>
                    <span>蓐收 · 秋神</span>
                </button>
                <button class="season-btn winter" data-season="winter">
                    <i class="fas fa-snowflake season-icon"></i>
                    <span>禺彊 · 冬神</span>
                </button>
                <button class="season-btn all" data-season="all">
                    <i class="fas fa-globe season-icon"></i>
                    <span>四季综合</span>
                </button>
            </div>
            
            <!-- 春神信息 -->
            <div class="god-info active" id="spring-info">
                <div class="god-name">
                    <i class="fas fa-seedling"></i>
                    <span>句芒</span>
                </div>
                <div class="god-season">春神 · 木正</div>
                
                <div class="keywords">
                    <div class="keyword">青</div>
                    <div class="keyword">木</div>
                    <div class="keyword">舒展</div>
                    <div class="keyword">萌芽</div>
                    <div class="keyword">羽</div>
                    <div class="keyword">龙</div>
                </div>
                
                <div class="info-section">
                    <h4>核心文献</h4>
                    <p>"鸟身人面，乘两龙" ——《山海经·海外东经》</p>
                </div>
                
                <div class="info-section">
                    <h4>形态解构方向</h4>
                    <p>流线羽翼 + 盘旋龙形曲线</p>
                </div>
                
                <div class="info-section">
                    <h4>视觉策略</h4>
                    <p>以青、木为主色调，提取"乘两龙"中的流线型羽翼轮廓与盘旋龙形曲线，表现春季舒展、萌芽的生机感。</p>
                </div>
            </div>
            
            <!-- 夏神信息 -->
            <div class="god-info" id="summer-info">
                <div class="god-name">
                    <i class="fas fa-fire"></i>
                    <span>祝融</span>
                </div>
                <div class="god-season">夏神 · 火正</div>
                
                <div class="keywords">
                    <div class="keyword">赤</div>
                    <div class="keyword">火</div>
                    <div class="keyword">升腾</div>
                    <div class="keyword">燥热</div>
                    <div class="keyword">兽面</div>
                    <div class="keyword">烈光</div>
                </div>
                
                <div class="info-section">
                    <h4>核心文献</h4>
                    <p>"兽身人面，乘两龙" ——《山海经·海外南经》</p>
                </div>
                
                <div class="info-section">
                    <h4>形态解构方向</h4>
                    <p>盘绕曲折 + 赤红火焰纹</p>
                </div>
                
                <div class="info-section">
                    <h4>视觉策略</h4>
                    <p>聚焦于盘绕曲折的形态与赤红火焰纹，以赤金+烬黑的渐变表现火焰燃烧后的炽热与灰烬，传递夏季的升腾与燥热感。</p>
                </div>
            </div>
            
            <!-- 秋神信息 -->
            <div class="god-info" id="autumn-info">
                <div class="god-name">
                    <i class="fas fa-leaf"></i>
                    <span>蓐收</span>
                </div>
                <div class="god-season">秋神 · 金正</div>
                
                <div class="keywords">
                    <div class="keyword">白</div>
                    <div class="keyword">金</div>
                    <div class="keyword">收割</div>
                    <div class="keyword">锋利</div>
                    <div class="keyword">蛇</div>
                    <div class="keyword">钺</div>
                </div>
                
                <div class="info-section">
                    <h4>核心文献</h4>
                    <p>"人面虎爪，执钺" ——《山海经·海外西经》</p>
                </div>
                
                <div class="info-section">
                    <h4>形态解构方向</h4>
                    <p>折线斧钺 + 蛇形盘绕</p>
                </div>
                
                <div class="info-section">
                    <h4>视觉策略</h4>
                    <p>将斧钺的折线与蛇形的盘绕结合，形成肃杀而精准的视觉感受，采用晧白+暗金+硃磦表现霜降、麦浪与落日。</p>
                </div>
            </div>
            
            <!-- 冬神信息 -->
            <div class="god-info" id="winter-info">
                <div class="god-name">
                    <i class="fas fa-snowflake"></i>
                    <span>禺彊</span>
                </div>
                <div class="god-season">冬神 · 海神/风神</div>
                
                <div class="keywords">
                    <div class="keyword">玄</div>
                    <div class="keyword">水</div>
                    <div class="keyword">寒冷</div>
                    <div class="keyword">深邃</div>
                    <div class="keyword">蛇</div>
                    <div class="keyword">鲲鹏</div>
                </div>
                
                <div class="info-section">
                    <h4>核心文献</h4>
                    <p>"人身鱼尾，珥两青蛇，践两青蛇" ——《山海经·大荒北经》</p>
                </div>
                
                <div class="info-section">
                    <h4>形态解构方向</h4>
                    <p>鲲鹏转化形态 + 蛇形盘绕</p>
                </div>
                
                <div class="info-section">
                    <h4>视觉策略</h4>
                    <p>紧扣"鲲化为鹏"的哲学意象，在"静默的鲲"与"振翅的鹏"之间取得视觉平衡，采用玄黑+深海蓝+冰晶白渐变，隐喻冬日蓄藏与终极转化的力量。</p>
                </div>
            </div>
            
            <!-- 四季综合信息 -->
            <div class="god-info" id="all-info">
                <div class="god-name">
                    <i class="fas fa-globe"></i>
                    <span>四季综合</span>
                </div>
                <div class="god-season">四季元素</div>
                
                <div class="keywords">
                    <div class="keyword">综合</div>
                    <div class="keyword">对比</div>
                    <div class="keyword">系统</div>
                    <div class="keyword">转化</div>
                    <div class="keyword">时序</div>
                    <div class="keyword">视觉</div>
                </div>
                
                <div class="info-section">
                    <h4>核心文献</h4>
                    <p>四时神祇视觉对比</p>
                </div>
                
                <div class="info-section">
                    <h4>形态解构方向</h4>
                    <p>系统化视觉转译</p>
                </div>
                
                <div class="info-section">
                    <h4>视觉策略</h4>
                    <p>综合四季神祇的视觉元素，形成完整的视觉转化系统，展现时序之神的系统化视觉语言。</p>
                </div>
            </div>
        </div>
        
        <!-- 中间主展示区 -->
        <div class="main-display" id="main-display">
            <h2 class="display-title" id="main-title">四季元素视觉展示</h2>
            
            <div class="main-image-container" id="main-image-container">
                <!-- 装饰边框 -->
                <div class="display-frame">
                    <div class="frame-corner tl"></div>
                    <div class="frame-corner tr"></div>
                    <div class="frame-corner bl"></div>
                    <div class="frame-corner br"></div>
                </div>
                
                <div class="image-placeholder" id="main-placeholder">
                    <i class="fas fa-mountain"></i>
                    <p>点击右侧图片素材直接查看</p>
                    <p>支持鼠标滚轮缩放和拖拽查看</p>
                </div>
                <img src="" alt="主展示图片" class="main-image" id="main-image" style="display: none;">
                
                <!-- 缩放控制 -->
                <div class="zoom-controls">
                    <button class="zoom-btn" id="zoom-out">
                        <i class="fas fa-search-minus"></i>
                    </button>
                    <button class="zoom-btn reset" id="zoom-reset">
                        <i class="fas fa-undo"></i>
                    </button>
                    <button class="zoom-btn" id="zoom-in">
                        <i class="fas fa-search-plus"></i>
                    </button>
                </div>
                
                <!-- 缩放级别显示 -->
                <div class="zoom-level" id="zoom-level" style="display: none;">
                    缩放: <span id="zoom-percent">100%</span>
                </div>
                
                <!-- 图片信息 -->
                <div class="image-info" id="image-info" style="display: none;">
                    <div class="image-title" id="current-image-title"></div>
                    <div class="image-description" id="current-image-description"></div>
                </div>
            </div>
            
            <!-- 可自定义介绍栏 -->
            <div class="custom-description-container" id="custom-description-container">
                <div class="custom-description-header">
                    <div class="custom-description-title">
                        <i class="fas fa-edit"></i>
                        <span>图片介绍</span>
                    </div>
                    <div class="description-controls">
                        <button class="description-btn" id="edit-description-btn">
                            <i class="fas fa-pencil-alt"></i>
                            <span>编辑</span>
                        </button>
                        <button class="description-btn" id="save-description-btn" style="display: none;">
                            <i class="fas fa-save"></i>
                            <span>保存</span>
                        </button>
                        <button class="description-btn" id="cancel-description-btn" style="display: none;">
                            <i class="fas fa-times"></i>
                            <span>取消</span>
                        </button>
                    </div>
                </div>
                <div class="custom-description-content" id="custom-description-content">
                    <div class="custom-description-placeholder" id="description-placeholder">
                        暂无介绍，点击上方"编辑"按钮添加自定义介绍
                    </div>
                </div>
                <textarea class="custom-description-edit" id="custom-description-edit" placeholder="请输入图片介绍..."></textarea>
            </div>
            
            <div class="main-controls">
                <button class="control-btn remove" id="remove-btn">
                    <i class="fas fa-times-circle"></i>
                    <span>清除展示</span>
                </button>
            </div>
            
            <div class="season-indicators">
                <div class="season-indicator spring active" data-season="spring">
                    <i class="fas fa-seedling"></i>
                </div>
                <div class="season-indicator summer" data-season="summer">
                    <i class="fas fa-fire"></i>
                </div>
                <div class="season-indicator autumn" data-season="autumn">
                    <i class="fas fa-leaf"></i>
                </div>
                <div class="season-indicator winter" data-season="winter">
                    <i class="fas fa-snowflake"></i>
                </div>
                <div class="season-indicator all" data-season="all">
                    <i class="fas fa-globe"></i>
                </div>
            </div>
        </div>
        
        <!-- 右侧图片面板 -->
        <div class="right-panel" id="right-panel">
            <div class="panel-title">
                <span>视觉素材库</span>
                <span id="image-count">10 张图片</span>
            </div>
            
            <!-- 上传控制区域 -->
            <div class="upload-section">
                <div class="upload-title">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <span>图片管理工具</span>
                </div>
                
                <div class="upload-controls">
                    <button class="upload-btn add-new" id="add-new-btn">
                        <i class="fas fa-plus-circle"></i>
                        <span>添加新图片</span>
                    </button>
                    <button class="upload-btn" id="replace-single-btn">
                        <i class="fas fa-exchange-alt"></i>
                        <span>替换选中图片</span>
                    </button>
                    <button class="upload-btn import-folder" id="import-folder-btn">
                        <i class="fas fa-folder-open"></i>
                        <span>导入文件夹</span>
                    </button>
                    <button class="upload-btn full" id="replace-all-btn">
                        <i class="fas fa-sync-alt"></i>
                        <span>批量替换所有图片</span>
                    </button>
                </div>
                
                <!-- 添加新图片表单 -->
                <div class="upload-form" id="add-new-form">
                    <div class="form-group">
                        <label class="form-label">图片标题</label>
                        <input type="text" id="new-image-title" class="form-input" placeholder="请输入图片标题" value="新图片">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">季节分类</label>
                        <select id="new-image-season" class="form-select">
                            <option value="spring">春 · 句芒</option>
                            <option value="summer">夏 · 祝融</option>
                            <option value="autumn">秋 · 蓐收</option>
                            <option value="winter">冬 · 禺彊</option>
                            <option value="all">四季综合</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">图片描述</label>
                        <input type="text" id="new-image-description" class="form-input" placeholder="请输入图片描述" value="用户添加图片">
                    </div>
                    
                    <div class="upload-area" id="new-upload-area">
                        <i class="fas fa-file-image"></i>
                        <p><strong>拖放或点击选择图片</strong></p>
                        <p style="font-size: 12px; opacity: 0.7;">支持 JPG, PNG, GIF, WEBP</p>
                        <p style="font-size: 11px; opacity: 0.5;">最大文件大小: 5MB</p>
                        <input type="file" id="new-image-upload" class="upload-input" accept="image/*">
                    </div>
                    
                    <div class="form-actions">
                        <button class="form-btn confirm" id="confirm-add-btn">
                            <i class="fas fa-check"></i>
                            确认添加
                        </button>
                        <button class="form-btn cancel" id="cancel-add-btn">
                            <i class="fas fa-times"></i>
                            取消
                        </button>
                    </div>
                </div>
                
                <!-- 文件夹导入区域 -->
                <div class="folder-import-container" id="folder-import-container">
                    <div class="upload-title">
                        <i class="fas fa-folder-plus"></i>
                        <span>导入文件夹中的图片</span>
                    </div>
                    
                    <div class="upload-area" id="folder-upload-area">
                        <i class="fas fa-folder"></i>
                        <p><strong>拖放或点击选择文件夹</strong></p>
                        <p style="font-size: 12px; opacity: 0.7;">将自动导入文件夹中的所有图片</p>
                        <p style="font-size: 11px; opacity: 0.5;">支持常见图片格式</p>
                        <input type="file" id="folder-upload" class="upload-input" webkitdirectory directory multiple accept="image/*">
                    </div>
                    
                    <div class="folder-structure" id="folder-structure">
                        <!-- 文件夹结构将在这里动态生成 -->
                    </div>
                    
                    <div class="form-actions" id="folder-actions" style="display: none;">
                        <button class="form-btn confirm" id="confirm-folder-btn">
                            <i class="fas fa-file-import"></i>
                            导入全部图片
                        </button>
                        <button class="form-btn cancel" id="cancel-folder-btn">
                            <i class="fas fa-times"></i>
                            取消
                        </button>
                    </div>
                </div>
                
                <!-- 重命名表单 -->
                <div class="upload-form" id="rename-form">
                    <div class="form-group">
                        <label class="form-label">新图片标题</label>
                        <input type="text" id="rename-image-title" class="form-input" placeholder="请输入新标题">
                    </div>
                    
                    <div class="form-actions">
                        <button class="form-btn confirm" id="confirm-rename-btn">
                            <i class="fas fa-check"></i>
                            确认重命名
                        </button>
                        <button class="form-btn cancel" id="cancel-rename-btn">
                            <i class="fas fa-times"></i>
                            取消
                        </button>
                    </div>
                </div>
                
                <!-- 单个替换区域 -->
                <div class="upload-area" id="single-upload-area">
                    <i class="fas fa-image"></i>
                    <p><strong>拖放或点击选择图片</strong></p>
                    <p class="form-label">替换选中的图片</p>
                    <input type="file" id="single-image-upload" class="upload-input" accept="image/*">
                </div>
                
                <!-- 批量替换区域 -->
                <div class="upload-area" id="bulk-upload-area">
                    <i class="fas fa-images"></i>
                    <p><strong>拖放或点击选择多个图片</strong></p>
                    <p class="form-label">按顺序替换所有图片</p>
                    <p class="file-count">已选择: <span id="bulk-file-count">0</span> 张图片</p>
                    <input type="file" id="bulk-image-upload" class="upload-input" accept="image/*" multiple>
                </div>
                
                <!-- 文件预览区域 -->
                <div class="file-preview-container" id="file-preview-container">
                    <div class="preview-title">
                        <i class="fas fa-eye"></i>
                        <span>图片预览</span>
                    </div>
                    <div class="preview-grid" id="preview-grid">
                        <!-- 预览图片将在这里动态生成 -->
                    </div>
                    <div class="preview-actions" id="preview-actions">
                        <button class="form-btn confirm" id="use-all-images">
                            <i class="fas fa-check-double"></i>
                            使用全部图片
                        </button>
                        <button class="form-btn cancel" id="clear-preview">
                            <i class="fas fa-trash"></i>
                            清除预览
                        </button>
                    </div>
                </div>
                
                <!-- 上传进度指示器 -->
                <div class="upload-progress" id="upload-progress">
                    <div class="progress-title">
                        <i class="fas fa-spinner fa-spin"></i>
                        <span>正在上传...</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <div class="progress-text" id="progress-text">准备上传...</div>
                </div>
                
                <!-- 上传成功提示 -->
                <div class="upload-success" id="upload-success">
                    <div class="success-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="success-text">图片上传成功！</div>
                    <div class="success-details" id="success-details"></div>
                    <div class="supported-formats">
                        <span class="file-type-tag">JPG</span>
                        <span class="file-type-tag">PNG</span>
                        <span class="file-type-tag">GIF</span>
                        <span class="file-type-tag">WEBP</span>
                        <span class="file-type-tag">SVG</span>
                    </div>
                </div>
                
                <div class="upload-info">
                    <p><i class="fas fa-info-circle"></i> 支持拖放上传，点击图片可查看，右键可管理</p>
                </div>
            </div>
            
            <!-- 图片库 -->
            <div class="image-gallery" id="image-gallery">
                <!-- 图片将通过JavaScript动态加载 -->
                <div class="empty-message">
                    <i class="fas fa-spinner fa-spin"></i>
                    <p>加载视觉素材库...</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 底部导航栏切换按钮 -->
    <div class="bottom-nav-toggle" id="bottom-nav-toggle">
        <i class="fas fa-chevron-up" id="toggle-icon"></i>
    </div>
    
    <!-- 底部导航栏 -->
    <div class="bottom-nav" id="bottom-nav">
        <div class="nav-item" data-action="home">
            <i class="fas fa-home"></i>
            <span>首页</span>
        </div>
        <div class="nav-item" data-action="info">
            <i class="fas fa-info-circle"></i>
            <span>关于</span>
        </div>
        <div class="nav-item" data-action="gallery">
            <i class="fas fa-images"></i>
            <span>图库</span>
        </div>
        <div class="nav-item" data-action="export">
            <i class="fas fa-download"></i>
            <span>导出</span>
        </div>
        <div class="nav-item" data-action="settings">
            <i class="fas fa-cog"></i>
            <span>设置</span>
        </div>
    </div>

    <script>
        // 增强版的神话视觉转化系统
        
        // 四季神祇数据
        const godsData = {
            spring: {
                name: "句芒",
                season: "春神 · 木正",
                keywords: ["青", "木", "舒展", "萌芽", "羽", "龙"],
                literature: "鸟身人面，乘两龙 ——《山海经·海外东经》",
                direction: "流线羽翼 + 盘旋龙形曲线",
                strategy: "以青、木为主色调，提取'乘两龙'中的流线型羽翼轮廓与盘旋龙形曲线，表现春季舒展、萌芽的生机感。",
                color: "#2ecc71",
                secondary: "#27ae60",
                gradient: "linear-gradient(135deg, #2ecc71, #27ae60)",
                decorations: ["decoration-spring"]
            },
            summer: {
                name: "祝融",
                season: "夏神 · 火正",
                keywords: ["赤", "火", "升腾", "燥热", "兽面", "烈光"],
                literature: "兽身人面，乘两龙 ——《山海经·海外南经》",
                direction: "盘绕曲折 + 赤红火焰纹",
                strategy: "聚焦于盘绕曲折的形态与赤红火焰纹，以赤金+烬黑的渐变表现火焰燃烧后的炽热与灰烬，传递夏季的升腾与燥热感。",
                color: "#e74c3c",
                secondary: "#c0392b",
                gradient: "linear-gradient(135deg, #e74c3c, #c0392b)",
                decorations: ["decoration-summer"]
            },
            autumn: {
                name: "蓐收",
                season: "秋神 · 金正",
                keywords: ["白", "金", "收割", "锋利", "蛇", "钺"],
                literature: "人面虎爪，执钺 ——《山海经·海外西经》",
                direction: "折线斧钺 + 蛇形盘绕",
                strategy: "将斧钺的折线与蛇形的盘绕结合，形成肃杀而精准的视觉感受，采用晧白+暗金+硃磦表现霜降、麦浪与落日。",
                color: "#f39c12",
                secondary: "#d35400",
                gradient: "linear-gradient(135deg, #f39c12, #d35400)",
                decorations: ["decoration-autumn"]
            },
            winter: {
                name: "禺彊",
                season: "冬神 · 海神/风神",
                keywords: ["玄", "水", "寒冷", "深邃", "蛇", "鲲鹏"],
                literature: "人身鱼尾，珥两青蛇，践两青蛇 ——《山海经·大荒北经》",
                direction: "鲲鹏转化形态 + 蛇形盘绕",
                strategy: "紧扣'鲲化为鹏'的哲学意象，在'静默的鲲'与'振翅的鹏'之间取得视觉平衡，采用玄黑+深海蓝+冰晶白渐变，隐喻冬日蓄藏与终极转化的力量。",
                color: "#3498db",
                secondary: "#2980b9",
                gradient: "linear-gradient(135deg, #3498db, #2980b9)",
                decorations: ["decoration-winter"]
            },
            all: {
                name: "四季综合",
                season: "四季元素",
                keywords: ["综合", "对比", "系统", "转化", "时序", "视觉"],
                literature: "四时神祇视觉对比",
                direction: "系统化视觉转译",
                strategy: "综合四季神祇的视觉元素，形成完整的视觉转化系统，展现时序之神的系统化视觉语言。",
                color: "#9b59b6",
                secondary: "#8e44ad",
                gradient: "linear-gradient(135deg, #9b59b6, #8e44ad)",
                decorations: ["decoration-all", "decoration-spring", "decoration-summer", "decoration-autumn", "decoration-winter"]
            }
        };

        // 图片素材数据 - 初始数据
        let imageData = [
            // 春季图片
            { 
                id: 1, 
                season: "spring", 
                title: "句芒主形象设计", 
                description: "流线型羽翼与龙形曲线结合",
                customDescription: "春神句芒的形象设计，融合了流线型羽翼与盘旋龙形曲线，展现了春季的生机与舒展感。",
                color: "#2ecc71",
                secondary: "#27ae60",
                type: "customizable",
                url: null,
                gradient: "linear-gradient(135deg, #2ecc71, #27ae60)"
            },
            { 
                id: 2, 
                season: "spring", 
                title: "春神色彩情绪版", 
                description: "萌芽绿+沙青的渐变体系",
                customDescription: "春季色彩情绪版，以萌芽绿与沙青为主色调，形成柔和渐变的色彩体系，表现春季的生机与活力。",
                color: "#2ecc71",
                secondary: "#27ae60",
                type: "customizable",
                url: null,
                gradient: "linear-gradient(135deg, #2ecc71, #27ae60)"
            },
            // 夏季图片
            { 
                id: 3, 
                season: "summer", 
                title: "祝融主形象设计", 
                description: "盘绕曲折与赤红火焰纹结合",
                customDescription: "夏神祝融的形象设计，融合盘绕曲折的形态与赤红火焰纹，展现夏季的炽热与升腾感。",
                color: "#e74c3c",
                secondary: "#c0392b",
                type: "customizable",
                url: null,
                gradient: "linear-gradient(135deg, #e74c3c, #c0392b)"
            },
            { 
                id: 4, 
                season: "summer", 
                title: "夏神动态标志", 
                description: "火焰盘绕至爆燃的循环动态",
                customDescription: "夏季动态标志设计，表现火焰从盘绕到爆燃的循环动态，象征夏季的炽烈与能量释放。",
                color: "#e74c3c",
                secondary: "#c0392b",
                type: "customizable",
                url: null,
                gradient: "linear-gradient(135deg, #e74c3c, #c0392b)"
            },
            // 秋季图片
            { 
                id: 5, 
                season: "autumn", 
                title: "蓐收主形象设计", 
                description: "斧钺折线与蛇形盘绕",
                customDescription: "秋神蓐收的形象设计，结合斧钺的折线与蛇形盘绕，形成肃杀而精准的视觉感受。",
                color: "#f39c12",
                secondary: "#d35400",
                type: "customizable",
                url: null,
                gradient: "linear-gradient(135deg, #f39c12, #d35400)"
            },
            { 
                id: 6, 
                season: "autumn", 
                title: "秋神辅助图形", 
                description: "收割纹样与折线系统",
                customDescription: "秋季辅助图形设计，提取收割纹样与折线系统，表现秋季的丰收与肃杀感。",
                color: "#f39c12",
                secondary: "#d35400",
                type: "customizable",
                url: null,
                gradient: "linear-gradient(135deg, #f39c12, #d35400)"
            },
            // 冬季图片
            { 
                id: 7, 
                season: "winter", 
                title: "禺彊主形象设计", 
                description: "鲲鹏转化形态的视觉凝练",
                customDescription: "冬神禺彊的形象设计，凝练鲲鹏转化形态，在静默与振翅之间取得视觉平衡。",
                color: "#3498db",
                secondary: "#2980b9",
                type: "customizable",
                url: null,
                gradient: "linear-gradient(135deg, #3498db, #2980b9)"
            },
            { 
                id: 8, 
                season: "winter", 
                title: "冬神概念海报", 
                description: "玄黑+深海蓝+冰晶白渐变",
                customDescription: "冬季概念海报设计，采用玄黑+深海蓝+冰晶白渐变，隐喻冬日蓄藏与终极转化的力量。",
                color: "#3498db",
                secondary: "#2980b9",
                type: "customizable",
                url: null,
                gradient: "linear-gradient(135deg, #3498db, #2980b9)"
            },
            // 四季综合
            { 
                id: 9, 
                season: "all", 
                title: "四季神视觉系统", 
                description: "四时神祇视觉对比",
                customDescription: "四季神祇视觉系统对比，展现时序之神的系统化视觉语言与转化关系。",
                color: "#9b59b6",
                secondary: "#8e44ad",
                type: "customizable",
                url: null,
                gradient: "linear-gradient(135deg, #9b59b6, #8e44ad)"
            },
            { 
                id: 10, 
                season: "all", 
                title: "时序之灵文创体系", 
                description: "丝巾、香器、茶包等衍生品",
                customDescription: "时序之灵文创体系设计，包含丝巾、香器、茶包等衍生品，将神话视觉元素融入日常生活。",
                color: "#9b59b6",
                secondary: "#8e44ad",
                type: "customizable",
                url: null,
                gradient: "linear-gradient(135deg, #9b59b6, #8e44ad)"
            }
        ];

        // 系统变量
        let currentSeason = "spring";
        let selectedImageId = null;
        let currentMainImageId = null;
        let nextImageId = 11;
        let imageToRename = null;
        let newImageFile = null;
        let newImageUrl = null;
        
        // 缩放相关变量
        let currentScale = 1;
        let isDragging = false;
        let dragStartX = 0;
        let dragStartY = 0;
        let translateX = 0;
        let translateY = 0;
        
        // 上传相关变量
        let folderFiles = [];
        let selectedFolderPath = '';
        let currentPreviewFiles = [];
        let isProcessingUpload = false;
        
        // 粒子效果变量
        let particlesCanvas, particlesCtx;
        let particles = [];
        let particleAnimationId;
        
        // 星星变量
        let stars = [];
        
        // 底部导航栏状态
        let isBottomNavHidden = false;
        
        // 自定义介绍状态
        let isEditingDescription = false;
        
        // 本地存储键名
        const STORAGE_KEY = 'myth_visual_system_data_v2';
        const IMAGE_STORAGE_KEY = 'myth_visual_system_images_v2';
        
        // DOM 元素引用
        const introOverlay = document.getElementById('intro-overlay');
        const fullscreenBackground = document.getElementById('fullscreen-background');
        const starField = document.getElementById('star-field');
        const seasonTransitionOverlay = document.getElementById('season-transition-overlay');
        const decorations = {
            spring: document.getElementById('decoration-spring'),
            summer: document.getElementById('decoration-summer'),
            autumn: document.getElementById('decoration-autumn'),
            winter: document.getElementById('decoration-winter'),
            all: document.getElementById('decoration-all')
        };

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 创建星空
            createStarField();
            
            // 从本地存储加载数据
            loadFromLocalStorage();
            
            // 初始化图片库
            loadImagesForSeason(currentSeason);
            
            // 季节按钮点击事件
            document.querySelectorAll('.season-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const season = this.getAttribute('data-season');
                    switchSeasonWithAnimation(season);
                });
            });
            
            // 季节指示器点击事件
            document.querySelectorAll('.season-indicator').forEach(indicator => {
                indicator.addEventListener('click', function() {
                    const season = this.getAttribute('data-season');
                    switchSeasonWithAnimation(season);
                });
            });
            
            // 底部导航栏点击事件
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    const action = this.getAttribute('data-action');
                    handleNavAction(action);
                });
            });
            
            // 底部导航栏切换按钮事件
            document.getElementById('bottom-nav-toggle').addEventListener('click', toggleBottomNav);
            
            // 清除展示按钮
            document.getElementById('remove-btn').addEventListener('click', removeMainImage);
            
            // 添加上传相关按钮事件
            document.getElementById('add-new-btn').addEventListener('click', showAddNewForm);
            document.getElementById('replace-single-btn').addEventListener('click', () => {
                hideAllForms();
                document.getElementById('single-upload-area').classList.add('active');
                document.getElementById('bulk-upload-area').classList.remove('active');
                showMessage('请选择图片替换当前选中的项目', 'info');
            });
            
            document.getElementById('replace-all-btn').addEventListener('click', () => {
                hideAllForms();
                document.getElementById('bulk-upload-area').classList.add('active');
                document.getElementById('single-upload-area').classList.remove('active');
                showMessage('请选择多张图片按顺序替换所有项目', 'info');
            });
            
            // 文件夹导入按钮
            document.getElementById('import-folder-btn').addEventListener('click', showFolderImport);
            
            // 上传区域点击事件
            document.getElementById('single-upload-area').addEventListener('click', () => document.getElementById('single-image-upload').click());
            document.getElementById('bulk-upload-area').addEventListener('click', () => document.getElementById('bulk-image-upload').click());
            document.getElementById('new-upload-area').addEventListener('click', () => document.getElementById('new-image-upload').click());
            document.getElementById('folder-upload-area').addEventListener('click', () => document.getElementById('folder-upload').click());
            
            // 文件选择变化事件
            document.getElementById('single-image-upload').addEventListener('change', (e) => {
                if (e.target.files.length) {
                    handleSingleImageUpload(e.target.files[0]);
                }
            });
            
            document.getElementById('bulk-image-upload').addEventListener('change', (e) => {
                if (e.target.files.length) {
                    updateBulkFileCount(e);
                    previewBulkImages(e.target.files);
                }
            });
            
            document.getElementById('new-image-upload').addEventListener('change', (e) => {
                if (e.target.files.length) {
                    handleNewImageUpload(e.target.files[0]);
                }
            });
            
            document.getElementById('folder-upload').addEventListener('change', (e) => {
                if (e.target.files.length) {
                    handleFolderUpload(e);
                }
            });
            
            // 表单按钮事件
            document.getElementById('confirm-add-btn').addEventListener('click', confirmAddNewImage);
            document.getElementById('cancel-add-btn').addEventListener('click', hideAddNewForm);
            document.getElementById('confirm-rename-btn').addEventListener('click', confirmRenameImage);
            document.getElementById('cancel-rename-btn').addEventListener('click', hideRenameForm);
            document.getElementById('confirm-folder-btn').addEventListener('click', confirmFolderImport);
            document.getElementById('cancel-folder-btn').addEventListener('click', cancelFolderImport);
            
            // 预览操作按钮
            document.getElementById('use-all-images').addEventListener('click', useAllPreviewImages);
            document.getElementById('clear-preview').addEventListener('click', clearPreview);
            
            // 自定义介绍按钮事件
            document.getElementById('edit-description-btn').addEventListener('click', editDescription);
            document.getElementById('save-description-btn').addEventListener('click', saveDescription);
            document.getElementById('cancel-description-btn').addEventListener('click', cancelEditDescription);
            
            // 拖放功能
            setupDragAndDrop();
            
            // 缩放按钮事件
            document.getElementById('zoom-in').addEventListener('click', () => zoomImage(1.2));
            document.getElementById('zoom-out').addEventListener('click', () => zoomImage(0.8));
            document.getElementById('zoom-reset').addEventListener('click', resetZoom);
            
            // 鼠标滚轮缩放
            document.getElementById('main-image-container').addEventListener('wheel', handleMouseWheel, { passive: false });
            
            // 图片拖拽事件
            const mainImage = document.getElementById('main-image');
            mainImage.addEventListener('mousedown', startDrag);
            document.addEventListener('mousemove', handleDrag);
            document.addEventListener('mouseup', stopDrag);
            
            // 初始化粒子效果
            initParticles();
            
            // 应用初始主题
            applyTheme(currentSeason);
            updateBackgroundTheme(currentSeason);
            updateDecorations(currentSeason);
            
            // 开始自动保存
            startAutoSave();
            
            // 显示欢迎消息
            setTimeout(() => {
                showMessage('欢迎来到四时巡游神话视觉转化系统', 'info');
            }, 4500);
            
            // 添加快捷键支持
            setupKeyboardShortcuts();
            
            console.log('系统初始化完成');
        });

        // 从本地存储加载数据
        function loadFromLocalStorage() {
            try {
                const savedData = localStorage.getItem(STORAGE_KEY);
                const savedImages = localStorage.getItem(IMAGE_STORAGE_KEY);
                
                if (savedData) {
                    const parsedData = JSON.parse(savedData);
                    
                    // 恢复图片的自定义介绍
                    if (parsedData.imageDescriptions) {
                        parsedData.imageDescriptions.forEach(item => {
                            const image = imageData.find(img => img.id === item.id);
                            if (image) {
                                image.customDescription = item.description || "";
                            }
                        });
                    }
                    
                    // 恢复设置
                    if (parsedData.settings) {
                        currentSeason = parsedData.settings.currentSeason || currentSeason;
                        isBottomNavHidden = parsedData.settings.isBottomNavHidden || false;
                        
                        if (isBottomNavHidden) {
                            document.getElementById('bottom-nav').classList.add('hidden');
                            document.getElementById('toggle-icon').classList.remove('fa-chevron-up');
                            document.getElementById('toggle-icon').classList.add('fa-chevron-down');
                        }
                    }
                }
                
                // 注意：实际项目中，本地存储的图片URL（blob URLs）在页面刷新后会失效
                // 这里我们只保存图片信息，用户需要重新上传图片
                
            } catch (error) {
                console.error('加载本地存储数据失败:', error);
            }
        }

        // 保存到本地存储
        function saveToLocalStorage() {
            try {
                const dataToSave = {
                    imageDescriptions: imageData.map(img => ({
                        id: img.id,
                        description: img.customDescription || ''
                    })),
                    settings: {
                        isBottomNavHidden: isBottomNavHidden,
                        currentSeason: currentSeason,
                        lastUpdate: new Date().toISOString()
                    },
                    systemVersion: '2.0'
                };
                
                localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));
                console.log('数据已保存到本地存储');
            } catch (error) {
                console.error('保存到本地存储失败:', error);
            }
        }

        // 开始自动保存
        function startAutoSave() {
            // 每30秒保存一次
            setInterval(saveToLocalStorage, 30000);
            
            // 在页面卸载前保存
            window.addEventListener('beforeunload', saveToLocalStorage);
        }

        // 导出数据为JSON文件
        function exportData() {
            const exportData = {
                system: '四时巡游神话视觉转化系统',
                version: '2.0',
                exportDate: new Date().toISOString(),
                data: {
                    images: imageData.map(img => ({
                        id: img.id,
                        title: img.title,
                        description: img.description,
                        customDescription: img.customDescription || '',
                        season: img.season,
                        color: img.color,
                        secondary: img.secondary,
                        type: img.type,
                        uploadDate: img.uploadDate || new Date().toISOString()
                    })),
                    settings: {
                        currentSeason: currentSeason,
                        isBottomNavHidden: isBottomNavHidden
                    }
                }
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const downloadLink = document.createElement('a');
            downloadLink.href = url;
            downloadLink.download = `神话视觉系统_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(downloadLink);
            downloadLink.click();
            document.body.removeChild(downloadLink);
            URL.revokeObjectURL(url);
            
            showMessage('数据已导出为JSON文件', 'success');
        }

        // 导入数据
        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    if (importedData.system !== '四时巡游神话视觉转化系统') {
                        showMessage('文件格式不正确', 'error');
                        return;
                    }
                    
                    // 更新图片的自定义介绍
                    if (importedData.data && importedData.data.images) {
                        importedData.data.images.forEach(importedImg => {
                            const image = imageData.find(img => img.id === importedImg.id);
                            if (image) {
                                image.customDescription = importedImg.customDescription || '';
                            }
                        });
                    }
                    
                    // 更新设置
                    if (importedData.data && importedData.data.settings) {
                        currentSeason = importedData.data.settings.currentSeason || currentSeason;
                        isBottomNavHidden = importedData.data.settings.isBottomNavHidden || false;
                        
                        // 更新界面
                        if (isBottomNavHidden) {
                            document.getElementById('bottom-nav').classList.add('hidden');
                        } else {
                            document.getElementById('bottom-nav').classList.remove('hidden');
                        }
                        
                        // 重新加载当前季节
                        switchSeason(currentSeason);
                    }
                    
                    // 保存到本地存储
                    saveToLocalStorage();
                    
                    showMessage('数据导入成功', 'success');
                } catch (error) {
                    console.error('导入数据失败:', error);
                    showMessage('导入失败，文件格式错误', 'error');
                }
            };
            reader.readAsText(file);
        }

        // 创建星空背景
        function createStarField() {
            const starCount = 150;
            
            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                
                // 随机大小和位置
                const size = Math.random() * 3 + 1;
                const x = Math.random() * 100;
                const y = Math.random() * 100;
                const duration = Math.random() * 5 + 3;
                const delay = Math.random() * 5;
                
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                star.style.left = `${x}%`;
                star.style.top = `${y}%`;
                star.style.setProperty('--twinkle-duration', `${duration}s`);
                star.style.animationDelay = `${delay}s`;
                
                starField.appendChild(star);
                stars.push(star);
            }
        }

        // 带动画的季节切换
        function switchSeasonWithAnimation(season) {
            if (season === currentSeason) return;
            
            // 显示过渡效果
            seasonTransitionOverlay.style.opacity = '0.5';
            
            // 短暂延迟后切换季节
            setTimeout(() => {
                switchSeason(season);
                
                // 隐藏过渡效果
                setTimeout(() => {
                    seasonTransitionOverlay.style.opacity = '0';
                }, 500);
                
            }, 300);
        }

        // 切换季节
        function switchSeason(season) {
            currentSeason = season;
            
            // 更新季节按钮状态
            document.querySelectorAll('.season-btn').forEach(btn => {
                if (btn.getAttribute('data-season') === season) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            // 更新季节指示器状态
            document.querySelectorAll('.season-indicator').forEach(indicator => {
                if (indicator.getAttribute('data-season') === season) {
                    indicator.classList.add('active');
                } else {
                    indicator.classList.remove('active');
                }
            });
            
            // 更新神祇信息显示
            document.querySelectorAll('.god-info').forEach(section => {
                if (section.id === `${season}-info`) {
                    section.classList.add('active');
                } else {
                    section.classList.remove('active');
                }
            });
            
            // 更新图片库
            loadImagesForSeason(season);
            
            // 更新主标题
            updateMainTitle(season);
            
            // 应用主题颜色
            applyTheme(season);
            
            // 更新背景主题
            updateBackgroundTheme(season);
            
            // 更新装饰元素
            updateDecorations(season);
            
            // 更新粒子效果
            updateParticlesForSeason(season);
            
            // 保存设置
            saveToLocalStorage();
            
            // 显示季节切换消息
            const seasonNames = {
                spring: "春季",
                summer: "夏季", 
                autumn: "秋季",
                winter: "冬季",
                all: "四季综合"
            };
            showMessage(`已切换到${seasonNames[season]}主题`, 'success');
        }

        // 更新装饰元素
        function updateDecorations(season) {
            // 隐藏所有装饰
            Object.values(decorations).forEach(decoration => {
                decoration.style.opacity = '0';
            });
            
            // 显示当前季节的装饰
            const god = godsData[season];
            if (god && god.decorations) {
                god.decorations.forEach(decorationId => {
                    if (decorations[decorationId]) {
                        decorations[decorationId].style.opacity = '1';
                    }
                });
            }
        }

        // 更新背景主题
        function updateBackgroundTheme(season) {
            // 移除所有风景类
            const landscapeElements = document.getElementById('landscape-elements');
            landscapeElements.classList.remove('spring-landscape', 'summer-landscape', 'autumn-landscape', 'winter-landscape', 'all-landscape');
            
            // 添加当前季节的风景类
            landscapeElements.classList.add(`${season}-landscape`);
            
            // 更新全屏背景
            const god = godsData[season];
            if (god) {
                fullscreenBackground.style.background = `
                    radial-gradient(circle at 20% 30%, ${god.color}20 0%, transparent 70%),
                    radial-gradient(circle at 80% 70%, ${god.secondary}15 0%, transparent 70%)
                `;
            }
            
            // 增强背景可见度
            document.getElementById('theme-background').style.opacity = '0.3';
        }

        // 应用主题颜色
        function applyTheme(season) {
            const god = godsData[season];
            if (!god) return;
            
            // 移除所有主题类
            document.body.classList.remove('theme-spring', 'theme-summer', 'theme-autumn', 'theme-winter', 'theme-all');
            
            // 添加当前主题类
            document.body.classList.add(`theme-${season}`);
            
            // 应用CSS变量
            document.documentElement.style.setProperty('--theme-color', god.color);
            document.documentElement.style.setProperty('--theme-secondary', god.secondary);
            document.documentElement.style.setProperty('--theme-color-light', `rgba(${hexToRgb(god.color)}, 0.2)`);
            document.documentElement.style.setProperty('--theme-color-medium', `rgba(${hexToRgb(god.color)}, 0.5)`);
            document.documentElement.style.setProperty('--theme-color-dark', god.secondary);
            
            // 更新主标题渐变
            const mainTitle = document.getElementById('main-title');
            mainTitle.style.background = `linear-gradient(90deg, ${god.color}, ${god.secondary})`;
            
            // 更新Logo渐变
            const mainLogo = document.getElementById('main-logo');
            mainLogo.style.background = `linear-gradient(90deg, #4db8ff, ${god.color})`;
        }

        // 十六进制颜色转RGB
        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? 
                `${parseInt(result[1], 16)}, ${parseInt(result[2], 16)}, ${parseInt(result[3], 16)}` 
                : '52, 152, 219';
        }

        // 切换底部导航栏显示/隐藏
        function toggleBottomNav() {
            const bottomNav = document.getElementById('bottom-nav');
            const toggleIcon = document.getElementById('toggle-icon');
            
            if (isBottomNavHidden) {
                // 显示底部导航栏
                bottomNav.classList.remove('hidden');
                toggleIcon.classList.remove('fa-chevron-down');
                toggleIcon.classList.add('fa-chevron-up');
                showMessage('底部导航栏已显示', 'info');
            } else {
                // 隐藏底部导航栏
                bottomNav.classList.add('hidden');
                toggleIcon.classList.remove('fa-chevron-up');
                toggleIcon.classList.add('fa-chevron-down');
                showMessage('底部导航栏已隐藏', 'info');
            }
            
            isBottomNavHidden = !isBottomNavHidden;
            saveToLocalStorage();
        }

        // 处理底部导航动作
        function handleNavAction(action) {
            switch (action) {
                case 'home':
                    switchSeasonWithAnimation('spring');
                    showMessage('返回首页', 'info');
                    break;
                    
                case 'info':
                    showMessage('四时巡游神话视觉转化系统 v2.0 - 完整功能版', 'info');
                    break;
                    
                case 'gallery':
                    // 滚动到右侧面板
                    document.querySelector('.right-panel').scrollIntoView({ behavior: 'smooth' });
                    showMessage('浏览视觉素材库', 'info');
                    break;
                    
                case 'export':
                    exportData();
                    break;
                    
                case 'settings':
                    showMessage('系统设置功能开发中...', 'warning');
                    break;
            }
        }

        // 编辑自定义介绍
        function editDescription() {
            if (!currentMainImageId) {
                showMessage('请先选择一张图片', 'warning');
                return;
            }
            
            const image = imageData.find(img => img.id === currentMainImageId);
            if (!image) return;
            
            isEditingDescription = true;
            
            // 显示编辑区域，隐藏显示区域
            document.getElementById('custom-description-edit').style.display = 'block';
            document.getElementById('custom-description-content').style.display = 'none';
            
            // 设置编辑框内容
            const editArea = document.getElementById('custom-description-edit');
            editArea.value = image.customDescription || '';
            
            // 切换按钮显示
            document.getElementById('edit-description-btn').style.display = 'none';
            document.getElementById('save-description-btn').style.display = 'flex';
            document.getElementById('cancel-description-btn').style.display = 'flex';
            
            // 聚焦编辑框
            setTimeout(() => {
                editArea.focus();
                editArea.setSelectionRange(editArea.value.length, editArea.value.length);
            }, 100);
        }

        // 保存自定义介绍
        function saveDescription() {
            if (!currentMainImageId) return;
            
            const editArea = document.getElementById('custom-description-edit');
            const newDescription = editArea.value.trim();
            
            // 找到图片并更新自定义介绍
            const imageIndex = imageData.findIndex(img => img.id === currentMainImageId);
            if (imageIndex !== -1) {
                imageData[imageIndex].customDescription = newDescription;
                
                // 更新显示区域
                updateDescriptionDisplay(newDescription);
                
                // 保存到本地存储
                saveToLocalStorage();
                
                showMessage('图片介绍已保存', 'success');
            }
            
            // 退出编辑模式
            exitEditMode();
        }

        // 取消编辑自定义介绍
        function cancelEditDescription() {
            if (!currentMainImageId) return;
            
            const image = imageData.find(img => img.id === currentMainImageId);
            if (!image) return;
            
            // 更新显示区域为原始内容
            updateDescriptionDisplay(image.customDescription);
            
            // 退出编辑模式
            exitEditMode();
            
            showMessage('已取消编辑', 'info');
        }

        // 退出编辑模式
        function exitEditMode() {
            isEditingDescription = false;
            
            // 隐藏编辑区域，显示显示区域
            document.getElementById('custom-description-edit').style.display = 'none';
            document.getElementById('custom-description-content').style.display = 'block';
            
            // 切换按钮显示
            document.getElementById('edit-description-btn').style.display = 'flex';
            document.getElementById('save-description-btn').style.display = 'none';
            document.getElementById('cancel-description-btn').style.display = 'none';
        }

        // 更新介绍显示区域
        function updateDescriptionDisplay(description) {
            const descriptionContent = document.getElementById('custom-description-content');
            const placeholder = document.getElementById('description-placeholder');
            
            if (description && description.trim() !== '') {
                // 有自定义介绍
                placeholder.style.display = 'none';
                descriptionContent.innerHTML = `<div style="white-space: pre-wrap; line-height: 1.6;">${description}</div>`;
            } else {
                // 没有自定义介绍
                placeholder.style.display = 'block';
                descriptionContent.innerHTML = '<div class="custom-description-placeholder" id="description-placeholder">暂无介绍，点击上方"编辑"按钮添加自定义介绍</div>';
            }
        }

        // 隐藏所有表单和上传区域
        function hideAllForms() {
            document.getElementById('add-new-form').classList.remove('active');
            document.getElementById('rename-form').classList.remove('active');
            document.getElementById('folder-import-container').classList.remove('active');
            document.getElementById('single-upload-area').classList.remove('active');
            document.getElementById('bulk-upload-area').classList.remove('active');
            document.getElementById('file-preview-container').classList.remove('active');
        }

        // 显示添加新图片表单
        function showAddNewForm() {
            hideAllForms();
            document.getElementById('add-new-form').classList.add('active');
            
            // 自动生成默认标题
            const seasonNames = {
                spring: "春神",
                summer: "夏神", 
                autumn: "秋神",
                winter: "冬神",
                all: "四季"
            };
            const seasonName = seasonNames[currentSeason] || "自定义";
            document.getElementById('new-image-title').value = `${seasonName}自定义图片${nextImageId}`;
            document.getElementById('new-image-season').value = currentSeason;
            document.getElementById('new-image-description').value = "用户添加图片";
            
            newImageFile = null;
            if (newImageUrl) {
                URL.revokeObjectURL(newImageUrl);
                newImageUrl = null;
            }
            
            showMessage('请填写图片信息并上传图片', 'info');
        }

        // 隐藏添加新图片表单
        function hideAddNewForm() {
            document.getElementById('add-new-form').classList.remove('active');
            newImageFile = null;
            if (newImageUrl) {
                URL.revokeObjectURL(newImageUrl);
                newImageUrl = null;
            }
        }

        // 显示文件夹导入界面
        function showFolderImport() {
            hideAllForms();
            document.getElementById('folder-import-container').classList.add('active');
            document.getElementById('folder-structure').style.display = 'none';
            document.getElementById('folder-actions').style.display = 'none';
            
            folderFiles = [];
            selectedFolderPath = '';
            currentPreviewFiles = [];
            
            showMessage('请选择包含图片的文件夹，系统将自动导入所有图片', 'info');
        }

        // 处理文件夹上传
        function handleFolderUpload(event) {
            const files = Array.from(event.target.files);
            
            if (files.length === 0) {
                showMessage('文件夹中没有图片文件', 'warning');
                return;
            }
            
            // 筛选图片文件
            folderFiles = files.filter(file => file.type.match('image.*'));
            
            if (folderFiles.length === 0) {
                showMessage('文件夹中没有有效的图片文件', 'warning');
                return;
            }
            
            // 获取文件夹路径（从第一个文件的webkitRelativePath）
            if (files[0].webkitRelativePath) {
                selectedFolderPath = files[0].webkitRelativePath.split('/')[0];
            }
            
            // 显示文件夹结构
            displayFolderStructure(folderFiles);
            
            // 显示操作按钮
            document.getElementById('folder-actions').style.display = 'flex';
            
            showMessage(`找到 ${folderFiles.length} 张图片，请选择导入方式`, 'success');
        }

        // 显示文件夹结构
        function displayFolderStructure(files) {
            const folderStructure = document.getElementById('folder-structure');
            folderStructure.innerHTML = '';
            folderStructure.style.display = 'block';
            
            // 按文件夹分组
            const folderMap = new Map();
            
            files.forEach(file => {
                const path = file.webkitRelativePath || file.name;
                const parts = path.split('/');
                const folderName = parts.length > 1 ? parts[0] : '根目录';
                
                if (!folderMap.has(folderName)) {
                    folderMap.set(folderName, {
                        files: [],
                        count: 0
                    });
                }
                
                folderMap.get(folderName).files.push(file);
                folderMap.get(folderName).count++;
            });
            
            // 创建文件夹项
            folderMap.forEach((data, folderName) => {
                const folderItem = document.createElement('div');
                folderItem.className = 'folder-item';
                folderItem.innerHTML = `
                    <i class="fas fa-folder"></i>
                    <div class="folder-info">
                        <div class="folder-name">${folderName}</div>
                        <div class="folder-count">${data.count} 张图片</div>
                    </div>
                `;
                
                folderItem.addEventListener('click', () => {
                    // 预览该文件夹的图片
                    previewFolderImages(data.files, folderName);
                    document.querySelectorAll('.folder-item').forEach(item => {
                        item.classList.remove('selected');
                    });
                    folderItem.classList.add('selected');
                });
                
                folderStructure.appendChild(folderItem);
            });
            
            // 默认选择第一个文件夹
            const firstFolder = folderStructure.querySelector('.folder-item');
            if (firstFolder) {
                firstFolder.click();
            }
        }

        // 预览文件夹图片
        function previewFolderImages(files, folderName) {
            currentPreviewFiles = files;
            const previewGrid = document.getElementById('preview-grid');
            previewGrid.innerHTML = '';
            
            // 显示预览容器
            document.getElementById('file-preview-container').classList.add('active');
            document.getElementById('preview-actions').style.display = 'flex';
            
            // 限制预览数量
            const previewLimit = Math.min(files.length, 20);
            
            // 创建预览项
            for (let i = 0; i < previewLimit; i++) {
                const file = files[i];
                const previewItem = document.createElement('div');
                previewItem.className = 'preview-item';
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    previewItem.innerHTML = `
                        <img src="${e.target.result}" alt="${file.name}" class="preview-image">
                        <div class="preview-name">${file.name.length > 15 ? file.name.substring(0, 12) + '...' : file.name}</div>
                    `;
                };
                reader.readAsDataURL(file);
                
                previewGrid.appendChild(previewItem);
            }
            
            if (files.length > previewLimit) {
                const moreItem = document.createElement('div');
                moreItem.className = 'preview-item';
                moreItem.innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: center; height: 100%; background: rgba(255,255,255,0.05);">
                        <div style="text-align: center; color: #8aadcc;">
                            <i class="fas fa-ellipsis-h" style="font-size: 20px; margin-bottom: 5px;"></i>
                            <div style="font-size: 10px;">还有 ${files.length - previewLimit} 张</div>
                        </div>
                    </div>
                `;
                previewGrid.appendChild(moreItem);
            }
        }

        // 确认导入文件夹图片
        function confirmFolderImport() {
            if (currentPreviewFiles.length === 0) {
                showMessage('请先选择文件夹或图片', 'warning');
                return;
            }
            
            // 显示上传进度
            showUploadProgress();
            
            // 批量添加图片
            processBatchImageUpload(currentPreviewFiles, true);
        }

        // 取消文件夹导入
        function cancelFolderImport() {
            document.getElementById('folder-import-container').classList.remove('active');
            document.getElementById('file-preview-container').classList.remove('active');
            folderFiles = [];
            currentPreviewFiles = [];
            selectedFolderPath = '';
        }

        // 处理新图片上传
        function handleNewImageUpload(file) {
            // 检查文件类型
            if (!file.type.match('image.*')) {
                showMessage('请选择图片文件 (JPG, PNG, GIF, WEBP)', 'warning');
                return;
            }
            
            // 检查文件大小 (限制为5MB)
            if (file.size > 5 * 1024 * 1024) {
                showMessage('图片大小不能超过5MB', 'warning');
                return;
            }
            
            newImageFile = file;
            newImageUrl = URL.createObjectURL(file);
            
            // 显示预览
            showMessage('图片已选择，请填写信息并确认添加', 'success');
        }

        // 确认添加新图片
        function confirmAddNewImage() {
            if (!newImageFile) {
                showMessage('请先选择图片文件', 'warning');
                return;
            }
            
            const title = document.getElementById('new-image-title').value.trim();
            if (!title) {
                showMessage('请输入图片标题', 'warning');
                return;
            }
            
            const season = document.getElementById('new-image-season').value;
            const description = document.getElementById('new-image-description').value.trim() || "用户添加图片";
            
            // 季节对应的颜色
            const seasonColors = {
                spring: "#2ecc71",
                summer: "#e74c3c",
                autumn: "#f39c12",
                winter: "#3498db",
                all: "#9b59b6"
            };
            
            const seasonSecondaries = {
                spring: "#27ae60",
                summer: "#c0392b",
                autumn: "#d35400",
                winter: "#2980b9",
                all: "#8e44ad"
            };
            
            // 创建新的图片对象
            const newImage = {
                id: nextImageId++,
                season: season,
                title: title,
                description: description,
                customDescription: "这是您添加的自定义图片，可以点击编辑按钮添加详细介绍。",
                color: seasonColors[season] || "#9b59b6",
                secondary: seasonSecondaries[season] || "#8e44ad",
                type: "user",
                url: newImageUrl,
                file: newImageFile,
                uploadDate: new Date().toISOString(),
                gradient: `linear-gradient(135deg, ${seasonColors[season]}, ${seasonSecondaries[season]})`
            };
            
            // 添加到图片数据
            imageData.push(newImage);
            
            // 重置表单
            hideAddNewForm();
            
            // 重新加载当前季节的图片
            loadImagesForSeason(currentSeason);
            
            // 自动选择新添加的图片
            selectedImageId = newImage.id;
            
            // 保存到本地存储
            saveToLocalStorage();
            
            showMessage(`"${title}" 已成功添加到素材库`, 'success');
        }

        // 显示重命名表单
        function showRenameForm(image) {
            hideAllForms();
            document.getElementById('rename-form').classList.add('active');
            document.getElementById('rename-image-title').value = image.title;
            imageToRename = image.id;
            showMessage('请输入新的图片标题', 'info');
        }

        // 隐藏重命名表单
        function hideRenameForm() {
            document.getElementById('rename-form').classList.remove('active');
            imageToRename = null;
        }

        // 确认重命名图片
        function confirmRenameImage() {
            if (!imageToRename) {
                hideRenameForm();
                return;
            }
            
            const newTitle = document.getElementById('rename-image-title').value.trim();
            if (!newTitle) {
                showMessage('请输入新的图片标题', 'warning');
                return;
            }
            
            // 找到图片并重命名
            const imageIndex = imageData.findIndex(img => img.id === imageToRename);
            if (imageIndex !== -1) {
                const oldTitle = imageData[imageIndex].title;
                imageData[imageIndex].title = newTitle;
                
                // 重新加载图片库
                loadImagesForSeason(currentSeason);
                
                // 如果当前展示的是这张图片，更新展示区
                if (currentMainImageId === imageToRename) {
                    document.getElementById('main-title').textContent = newTitle;
                    document.getElementById('current-image-title').textContent = newTitle;
                }
                
                // 保存到本地存储
                saveToLocalStorage();
                
                showMessage(`已重命名"${oldTitle}"为"${newTitle}"`, 'success');
            }
            
            hideRenameForm();
        }

        // 处理单个图片上传
        function handleSingleImageUpload(file) {
            // 检查文件类型
            if (!file.type.match('image.*')) {
                showMessage('请选择图片文件 (JPG, PNG, GIF, WEBP)', 'warning');
                return;
            }
            
            // 检查文件大小 (限制为5MB)
            if (file.size > 5 * 1024 * 1024) {
                showMessage('图片大小不能超过5MB', 'warning');
                return;
            }
            
            // 如果没有选中图片
            if (!selectedImageId) {
                showMessage('请先在素材库中选择一张图片进行替换', 'warning');
                return;
            }
            
            // 创建临时URL
            const imageUrl = URL.createObjectURL(file);
            
            // 找到选中的图片并更新
            const imageIndex = imageData.findIndex(img => img.id === selectedImageId);
            if (imageIndex !== -1) {
                // 释放旧的URL（如果存在）
                if (imageData[imageIndex].url) {
                    URL.revokeObjectURL(imageData[imageIndex].url);
                }
                
                // 更新图片数据
                imageData[imageIndex].url = imageUrl;
                imageData[imageIndex].file = file;
                imageData[imageIndex].uploadDate = new Date().toISOString();
                
                // 重新加载图片库
                loadImagesForSeason(currentSeason);
                
                // 如果这张图片是当前主展示图片，也更新主展示区
                if (currentMainImageId === selectedImageId) {
                    document.getElementById('main-image').src = imageUrl;
                }
                
                // 保存到本地存储
                saveToLocalStorage();
                
                // 隐藏上传区域
                document.getElementById('single-upload-area').classList.remove('active');
                
                showMessage(`已替换"${imageData[imageIndex].title}"的图片`, 'success');
            }
        }

        // 更新批量文件计数
        function updateBulkFileCount(event) {
            const files = event.target.files;
            document.getElementById('bulk-file-count').textContent = files.length;
        }

        // 预览批量上传的图片
        function previewBulkImages(files) {
            currentPreviewFiles = Array.from(files);
            const previewGrid = document.getElementById('preview-grid');
            previewGrid.innerHTML = '';
            
            // 显示预览容器
            document.getElementById('file-preview-container').classList.add('active');
            document.getElementById('preview-actions').style.display = 'flex';
            
            // 创建预览项
            Array.from(files).slice(0, 12).forEach(file => {
                if (validateImageFile(file)) {
                    const previewItem = document.createElement('div');
                    previewItem.className = 'preview-item';
                    
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        previewItem.innerHTML = `
                            <img src="${e.target.result}" alt="${file.name}" class="preview-image">
                            <div class="preview-name">${file.name.length > 15 ? file.name.substring(0, 12) + '...' : file.name}</div>
                        `;
                    };
                    reader.readAsDataURL(file);
                    
                    previewGrid.appendChild(previewItem);
                }
            });
            
            if (files.length > 12) {
                const moreItem = document.createElement('div');
                moreItem.className = 'preview-item';
                moreItem.innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: center; height: 100%; background: rgba(255,255,255,0.05);">
                        <div style="text-align: center; color: #8aadcc;">
                            <i class="fas fa-ellipsis-h" style="font-size: 20px; margin-bottom: 5px;"></i>
                            <div style="font-size: 10px;">还有 ${files.length - 12} 张</div>
                        </div>
                    </div>
                `;
                previewGrid.appendChild(moreItem);
            }
        }

        // 使用所有预览图片
        function useAllPreviewImages() {
            if (currentPreviewFiles.length === 0) {
                showMessage('没有可用的预览图片', 'warning');
                return;
            }
            
            showUploadProgress();
            processBatchImageUpload(currentPreviewFiles, false);
        }

        // 清除预览
        function clearPreview() {
            document.getElementById('file-preview-container').classList.remove('active');
            currentPreviewFiles = [];
            document.getElementById('preview-grid').innerHTML = '';
            document.getElementById('bulk-upload-area').classList.remove('active');
        }

        // 显示上传进度
        function showUploadProgress() {
            document.getElementById('upload-progress').classList.add('active');
            document.getElementById('progress-fill').style.width = '0%';
            document.getElementById('progress-text').textContent = '准备上传...';
        }

        // 更新上传进度
        function updateUploadProgress(processed, total, currentFile) {
            const percent = Math.round((processed / total) * 100);
            document.getElementById('progress-fill').style.width = `${percent}%`;
            document.getElementById('progress-text').textContent = `正在上传 ${processed}/${total}: ${currentFile}`;
        }

        // 隐藏上传进度
        function hideUploadProgress() {
            setTimeout(() => {
                document.getElementById('upload-progress').classList.remove('active');
            }, 1000);
        }

        // 显示上传成功提示
        function showUploadSuccess(count, total) {
            document.getElementById('success-details').textContent = `成功上传 ${count}/${total} 张图片`;
            document.getElementById('upload-success').classList.add('active');
            
            setTimeout(() => {
                document.getElementById('upload-success').classList.remove('active');
            }, 3000);
        }

        // 验证图片文件
        function validateImageFile(file) {
            // 检查文件类型
            if (!file.type.match('image.*')) {
                console.warn(`文件 ${file.name} 不是图片文件，已跳过`);
                return false;
            }
            
            // 检查文件大小 (限制为5MB)
            if (file.size > 5 * 1024 * 1024) {
                console.warn(`文件 ${file.name} 大小超过5MB，已跳过`);
                return false;
            }
            
            return true;
        }

        // 批量处理图片上传
        function processBatchImageUpload(files, isFolderImport = false) {
            if (isProcessingUpload) {
                showMessage('已有上传任务在进行中，请稍候', 'warning');
                return;
            }
            
            isProcessingUpload = true;
            const totalFiles = files.length;
            let processedFiles = 0;
            let successfulUploads = 0;
            
            // 处理每张图片
            files.forEach((file, index) => {
                setTimeout(() => {
                    updateUploadProgress(processedFiles + 1, totalFiles, file.name);
                    
                    if (validateImageFile(file)) {
                        // 创建新的图片对象
                        const newImage = createImageFromFile(file, isFolderImport);
                        
                        // 添加到图片数据
                        imageData.push(newImage);
                        successfulUploads++;
                    }
                    
                    processedFiles++;
                    
                    // 检查是否全部处理完成
                    if (processedFiles === totalFiles) {
                        isProcessingUpload = false;
                        
                        // 更新界面
                        loadImagesForSeason(currentSeason);
                        hideUploadProgress();
                        showUploadSuccess(successfulUploads, totalFiles);
                        
                        // 清理
                        if (isFolderImport) {
                            cancelFolderImport();
                        } else {
                            clearPreview();
                        }
                        
                        // 保存到本地存储
                        saveToLocalStorage();
                        
                        showMessage(`成功添加 ${successfulUploads} 张图片到素材库`, 'success');
                    }
                }, index * 100); // 延迟以避免阻塞
            });
        }

        // 从文件创建图片对象
        function createImageFromFile(file, isFromFolder = false) {
            const imageUrl = URL.createObjectURL(file);
            const season = getSeasonForNewImage();
            
            // 从文件名提取标题（去除扩展名）
            let title = file.name.replace(/\.[^/.]+$/, "");
            
            // 如果来自文件夹，可以添加文件夹信息
            if (isFromFolder && selectedFolderPath) {
                title = `${selectedFolderPath}/${title}`;
            }
            
            return {
                id: nextImageId++,
                season: season,
                title: title,
                description: isFromFolder ? "从文件夹导入的图片" : "用户上传图片",
                customDescription: "您可以编辑此介绍，添加关于这张图片的详细信息。",
                color: getSeasonColor(season),
                secondary: getSeasonSecondaryColor(season),
                type: "user",
                url: imageUrl,
                file: file,
                uploadDate: new Date().toISOString(),
                gradient: `linear-gradient(135deg, ${getSeasonColor(season)}, ${getSeasonSecondaryColor(season)})`
            };
        }

        // 获取新图片的季节分类
        function getSeasonForNewImage() {
            // 可以根据当前选中的季节，或者随机分配
            return currentSeason !== 'all' ? currentSeason : 'spring';
        }

        // 获取季节颜色
        function getSeasonColor(season) {
            const colors = {
                spring: "#2ecc71",
                summer: "#e74c3c",
                autumn: "#f39c12",
                winter: "#3498db",
                all: "#9b59b6"
            };
            return colors[season] || "#9b59b6";
        }

        // 获取季节次要颜色
        function getSeasonSecondaryColor(season) {
            const secondaries = {
                spring: "#27ae60",
                summer: "#c0392b",
                autumn: "#d35400",
                winter: "#2980b9",
                all: "#8e44ad"
            };
            return secondaries[season] || "#8e44ad";
        }

        // 设置拖放功能
        function setupDragAndDrop() {
            const dropZones = [
                document.getElementById('new-upload-area'),
                document.getElementById('single-upload-area'),
                document.getElementById('bulk-upload-area'),
                document.getElementById('folder-upload-area'),
                document.getElementById('right-panel')
            ];
            
            dropZones.forEach(zone => {
                if (zone) {
                    zone.addEventListener('dragover', handleDragOver);
                    zone.addEventListener('dragleave', handleDragLeave);
                    zone.addEventListener('drop', handleDrop);
                }
            });
        }

        // 处理拖放悬停
        function handleDragOver(e) {
            e.preventDefault();
            e.stopPropagation();
            this.style.borderColor = 'var(--theme-color)';
            this.style.background = 'rgba(30, 60, 90, 0.4)';
        }

        // 处理拖放离开
        function handleDragLeave(e) {
            e.preventDefault();
            e.stopPropagation();
            this.style.borderColor = 'rgba(255, 255, 255, 0.2)';
            this.style.background = 'rgba(30, 45, 70, 0.3)';
        }

        // 处理拖放
        function handleDrop(e) {
            e.preventDefault();
            e.stopPropagation();
            
            this.style.borderColor = 'rgba(255, 255, 255, 0.2)';
            this.style.background = 'rgba(30, 45, 70, 0.3)';
            
            const files = e.dataTransfer.files;
            if (files.length === 0) return;
            
            const zoneId = this.id;
            
            if (zoneId === 'new-upload-area') {
                handleNewImageUpload(files[0]);
            } else if (zoneId === 'single-upload-area') {
                handleSingleImageUpload(files[0]);
            } else if (zoneId === 'bulk-upload-area') {
                previewBulkImages(files);
            } else if (zoneId === 'folder-upload-area') {
                // 模拟文件夹选择
                simulateFolderUpload(files);
            } else if (zoneId === 'right-panel') {
                handleRightPanelDrop(files, e);
            }
        }

        // 处理右侧面板拖放
        function handleRightPanelDrop(files, e) {
            // 检查是否是文件夹（通过文件路径判断）
            const hasFolderStructure = Array.from(files).some(file => 
                file.webkitRelativePath && file.webkitRelativePath.includes('/')
            );
            
            if (hasFolderStructure) {
                // 是文件夹，显示文件夹导入界面
                showFolderImport();
                simulateFolderUpload(files);
            } else if (files.length === 1) {
                // 单个文件，显示添加新图片表单
                showAddNewForm();
                handleNewImageUpload(files[0]);
            } else {
                // 多个文件，显示批量预览
                previewBulkImages(files);
                showMessage(`检测到 ${files.length} 张图片，请选择使用方式`, 'info');
            }
        }

        // 模拟文件夹上传（用于拖放）
        function simulateFolderUpload(files) {
            folderFiles = Array.from(files);
            
            if (folderFiles.length === 0) return;
            
            // 显示文件夹结构
            displayFolderStructure(folderFiles);
            document.getElementById('folder-actions').style.display = 'flex';
            
            showMessage(`从拖放检测到 ${folderFiles.length} 张图片`, 'success');
        }

        // 删除图片
        function deleteImage(imageId) {
            // 找到图片索引
            const imageIndex = imageData.findIndex(img => img.id === imageId);
            
            if (imageIndex === -1) return;
            
            const imageToDelete = imageData[imageIndex];
            
            // 如果是用户上传的图片，释放URL
            if (imageToDelete.type === 'user' && imageToDelete.url) {
                URL.revokeObjectURL(imageToDelete.url);
            }
            
            // 从数组中删除
            imageData.splice(imageIndex, 1);
            
            // 如果删除的是当前主展示图片，清除主展示区
            if (currentMainImageId === imageId) {
                removeMainImage();
            }
            
            // 如果删除的是当前选中的图片，重置选中状态
            if (selectedImageId === imageId) {
                selectedImageId = null;
            }
            
            // 重新加载图片库
            loadImagesForSeason(currentSeason);
            
            // 保存到本地存储
            saveToLocalStorage();
            
            showMessage(`已删除"${imageToDelete.title}"`, 'success');
        }

        // 加载对应季节的图片
        function loadImagesForSeason(season) {
            const imageGallery = document.getElementById('image-gallery');
            // 清空当前图片库
            imageGallery.innerHTML = '';
            
            // 筛选图片
            let filteredImages;
            if (season === 'all') {
                filteredImages = imageData;
            } else {
                filteredImages = imageData.filter(img => img.season === season || img.season === 'all');
            }
            
            // 更新图片计数
            document.getElementById('image-count').textContent = `${filteredImages.length} 张图片`;
            
            // 如果没有图片
            if (filteredImages.length === 0) {
                imageGallery.innerHTML = `
                    <div class="empty-message">
                        <i class="fas fa-images"></i>
                        <p>暂无该季节的视觉素材</p>
                        <p style="margin-top: 10px; font-size: 14px;">请使用上方"添加新图片"功能</p>
                    </div>
                `;
                return;
            }
            
            // 创建图片元素
            filteredImages.forEach(img => {
                const galleryItem = document.createElement('div');
                galleryItem.className = 'gallery-item';
                galleryItem.setAttribute('data-id', img.id);
                
                // 如果这张图片是当前主展示图片，添加active类
                if (img.id === currentMainImageId) {
                    galleryItem.classList.add('active');
                }
                
                // 检查图片是否有自定义URL
                const hasCustomImage = img.url !== null;
                
                galleryItem.innerHTML = `
                    ${hasCustomImage 
                        ? `<img src="${img.url}" alt="${img.title}" class="gallery-image">`
                        : `<div class="gallery-image" style="background: ${img.gradient}; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-image" style="font-size: 40px; color: white; opacity: 0.7;"></i>
                            <div style="position: absolute; bottom: 30px; color: white; font-size: 12px; text-align: center; width: 100%; padding: 0 10px;">
                                <i class="fas fa-upload"></i> 等待上传图片
                            </div>
                          </div>`
                    }
                    <div class="gallery-label">${img.title}</div>
                    <div class="gallery-controls">
                        <button class="gallery-control-btn rename" title="重命名">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="gallery-control-btn replace" title="替换图片">
                            <i class="fas fa-exchange-alt"></i>
                        </button>
                        ${img.type === 'user' ? '<button class="gallery-control-btn delete" title="删除图片"><i class="fas fa-trash"></i></button>' : ''}
                    </div>
                `;
                
                // 点击事件 - 直接切换到主展示区
                galleryItem.addEventListener('click', function(e) {
                    // 如果点击的是控制按钮，不触发主展示
                    if (e.target.closest('.gallery-control-btn')) {
                        return;
                    }
                    
                    // 检查是否有图片
                    if (!img.url) {
                        showMessage('该图片尚未上传，请先上传图片或选择其他图片', 'warning');
                        return;
                    }
                    
                    // 移除所有active类
                    document.querySelectorAll('.gallery-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    
                    // 为当前项添加active类
                    this.classList.add('active');
                    
                    // 设置选中的图片ID
                    selectedImageId = img.id;
                    
                    // 直接在主展示区显示图片
                    showImageInMainDisplay(img);
                });
                
                // 右键菜单事件
                galleryItem.addEventListener('contextmenu', function(e) {
                    e.preventDefault();
                    
                    // 设置选中的图片ID
                    selectedImageId = img.id;
                    
                    // 更新所有项目的选中状态
                    document.querySelectorAll('.gallery-item').forEach(item => {
                        if (parseInt(item.getAttribute('data-id')) === img.id) {
                            item.classList.add('active');
                        } else {
                            item.classList.remove('active');
                        }
                    });
                    
                    showMessage(`右键点击了"${img.title}"，可使用上方按钮进行管理`, 'info');
                });
                
                // 重命名按钮事件
                const renameBtn = galleryItem.querySelector('.rename');
                if (renameBtn) {
                    renameBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        
                        // 设置选中的图片ID
                        selectedImageId = img.id;
                        
                        // 显示重命名表单
                        showRenameForm(img);
                        
                        // 更新所有项目的选中状态
                        document.querySelectorAll('.gallery-item').forEach(item => {
                            if (parseInt(item.getAttribute('data-id')) === img.id) {
                                item.classList.add('active');
                            } else {
                                item.classList.remove('active');
                            }
                        });
                    });
                }
                
                // 替换按钮事件
                const replaceBtn = galleryItem.querySelector('.replace');
                if (replaceBtn) {
                    replaceBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        
                        // 设置选中的图片ID
                        selectedImageId = img.id;
                        
                        // 激活单个替换模式
                        hideAllForms();
                        document.getElementById('single-upload-area').classList.add('active');
                        
                        // 更新所有项目的选中状态
                        document.querySelectorAll('.gallery-item').forEach(item => {
                            if (parseInt(item.getAttribute('data-id')) === img.id) {
                                item.classList.add('active');
                            } else {
                                item.classList.remove('active');
                            }
                        });
                        
                        showMessage(`准备替换"${img.title}"，请选择新图片`, 'info');
                    });
                }
                
                // 删除按钮事件
                const deleteBtn = galleryItem.querySelector('.delete');
                if (deleteBtn) {
                    deleteBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        
                        if (confirm(`确定要删除"${img.title}"吗？`)) {
                            deleteImage(img.id);
                        }
                    });
                }
                
                imageGallery.appendChild(galleryItem);
            });
            
            // 默认选中第一个
            if (filteredImages.length > 0 && selectedImageId === null) {
                const firstItem = imageGallery.querySelector('.gallery-item');
                if (firstItem) {
                    firstItem.classList.add('active');
                    selectedImageId = parseInt(firstItem.getAttribute('data-id'));
                    
                    // 如果有图片，自动显示到主展示区
                    const firstImage = imageData.find(img => img.id === selectedImageId);
                    if (firstImage && firstImage.url) {
                        showImageInMainDisplay(firstImage);
                    }
                }
            }
        }

        // 在主展示区显示图片
        function showImageInMainDisplay(image) {
            // 更新主展示区
            document.getElementById('main-placeholder').style.display = 'none';
            const mainImage = document.getElementById('main-image');
            mainImage.style.display = 'block';
            mainImage.src = image.url || '';
            mainImage.alt = image.title;
            
            // 更新标题
            document.getElementById('main-title').textContent = image.title;
            
            // 更新图片信息
            document.getElementById('current-image-title').textContent = image.title;
            document.getElementById('current-image-description').textContent = image.description;
            document.getElementById('image-info').style.display = 'block';
            
            // 设置当前主图片ID
            currentMainImageId = image.id;
            
            // 更新自定义介绍
            updateDescriptionDisplay(image.customDescription);
            
            // 重置缩放和位置
            resetZoom();
            
            // 显示缩放级别
            document.getElementById('zoom-level').style.display = 'block';
            
            // 显示成功消息
            showMessage(`正在展示: ${image.title}`, 'success');
        }

        // 移除主展示区的图片
        function removeMainImage() {
            if (currentMainImageId === null) {
                showMessage('主展示区当前没有图片', 'warning');
                return;
            }
            
            // 隐藏图片，显示占位符
            document.getElementById('main-image').style.display = 'none';
            document.getElementById('main-placeholder').style.display = 'flex';
            
            // 隐藏图片信息和缩放级别
            document.getElementById('image-info').style.display = 'none';
            document.getElementById('zoom-level').style.display = 'none';
            
            // 更新标题
            updateMainTitle(currentSeason);
            
            // 获取被移除的图片信息用于消息
            const removedImage = imageData.find(img => img.id === currentMainImageId);
            
            // 重置当前主图片ID
            currentMainImageId = null;
            
            // 重置自定义介绍
            updateDescriptionDisplay('');
            
            // 如果正在编辑描述，退出编辑模式
            if (isEditingDescription) {
                exitEditMode();
            }
            
            // 移除图片库中的active状态
            document.querySelectorAll('.gallery-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // 重置缩放
            resetZoom();
            
            // 显示成功消息
            if (removedImage) {
                showMessage(`已从主展示区移除"${removedImage.title}"`, 'success');
            }
        }

        // 更新主标题
        function updateMainTitle(season) {
            const god = godsData[season];
            if (god) {
                document.getElementById('main-title').textContent = `${god.name} · ${god.season}`;
            } else {
                const seasonNames = {
                    spring: "春神句芒 · 生命初萌",
                    summer: "夏神祝融 · 炽烈升腾", 
                    autumn: "秋神蓐收 · 肃杀收割",
                    winter: "冬神禺彊 · 蓄藏转化",
                    all: "四季元素视觉展示"
                };
                document.getElementById('main-title').textContent = seasonNames[season] || "四季元素视觉展示";
            }
        }

        // 缩放图片
        function zoomImage(factor) {
            currentScale *= factor;
            
            // 限制缩放范围
            if (currentScale < 0.1) currentScale = 0.1;
            if (currentScale > 10) currentScale = 10;
            
            // 应用缩放
            const mainImage = document.getElementById('main-image');
            mainImage.style.transform = `scale(${currentScale}) translate(${translateX}px, ${translateY}px)`;
            
            // 更新缩放百分比显示
            document.getElementById('zoom-percent').textContent = `${Math.round(currentScale * 100)}%`;
            
            // 显示提示
            if (factor > 1) {
                showMessage(`放大至 ${Math.round(currentScale * 100)}%`, 'info');
            } else {
                showMessage(`缩小至 ${Math.round(currentScale * 100)}%`, 'info');
            }
        }

        // 重置缩放
        function resetZoom() {
            currentScale = 1;
            translateX = 0;
            translateY = 0;
            
            // 重置变换
            const mainImage = document.getElementById('main-image');
            mainImage.style.transform = 'scale(1) translate(0px, 0px)';
            
            // 更新缩放百分比显示
            document.getElementById('zoom-percent').textContent = '100%';
            
            // 显示提示
            showMessage('已重置缩放和位置', 'success');
        }

        // 处理鼠标滚轮
        function handleMouseWheel(e) {
            e.preventDefault();
            
            // 判断是放大还是缩小
            if (e.deltaY < 0) {
                // 向上滚动，放大
                zoomImage(1.1);
            } else {
                // 向下滚动，缩小
                zoomImage(0.9);
            }
        }

        // 开始拖拽
        function startDrag(e) {
            if (currentScale <= 1) return; // 只有在放大时才允许拖拽
            
            isDragging = true;
            dragStartX = e.clientX - translateX;
            dragStartY = e.clientY - translateY;
            const mainImage = document.getElementById('main-image');
            mainImage.style.cursor = 'grabbing';
        }

        // 处理拖拽
        function handleDrag(e) {
            if (!isDragging) return;
            
            translateX = e.clientX - dragStartX;
            translateY = e.clientY - dragStartY;
            
            // 应用变换
            const mainImage = document.getElementById('main-image');
            mainImage.style.transform = `scale(${currentScale}) translate(${translateX}px, ${translateY}px)`;
        }

        // 停止拖拽
        function stopDrag() {
            isDragging = false;
            const mainImage = document.getElementById('main-image');
            mainImage.style.cursor = 'grab';
        }

        // 增强版显示消息
        function showMessage(text, type = 'info', duration = 3000) {
            // 移除旧消息
            const oldMessages = document.querySelectorAll('.custom-message');
            oldMessages.forEach(msg => msg.remove());
            
            // 类型样式
            const typeStyles = {
                info: { 
                    background: 'linear-gradient(135deg, rgba(52, 152, 219, 0.9), rgba(41, 128, 185, 0.9))',
                    icon: 'info-circle',
                    border: '#3498db'
                },
                success: { 
                    background: 'linear-gradient(135deg, rgba(46, 204, 113, 0.9), rgba(39, 174, 96, 0.9))',
                    icon: 'check-circle',
                    border: '#2ecc71'
                },
                warning: { 
                    background: 'linear-gradient(135deg, rgba(241, 196, 15, 0.9), rgba(243, 156, 18, 0.9))',
                    icon: 'exclamation-circle',
                    border: '#f1c40f'
                },
                error: { 
                    background: 'linear-gradient(135deg, rgba(231, 76, 60, 0.9), rgba(192, 57, 43, 0.9))',
                    icon: 'times-circle',
                    border: '#e74c3c'
                }
            };
            
            const style = typeStyles[type] || typeStyles.info;
            
            // 创建消息元素
            const messageEl = document.createElement('div');
            messageEl.className = 'custom-message';
            messageEl.innerHTML = `
                <i class="fas fa-${style.icon}"></i>
                <span>${text}</span>
            `;
            
            messageEl.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${style.background};
                color: white;
                padding: 15px 25px;
                border-radius: 12px;
                border-left: 5px solid ${style.border};
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
                z-index: 1000;
                display: flex;
                align-items: center;
                gap: 12px;
                font-size: 14px;
                max-width: 400px;
                backdrop-filter: blur(10px);
                animation: messageSlideIn 0.5s ease, messageSlideOut 0.5s ease ${duration/1000}s forwards;
                transform: translateX(100px);
                opacity: 0;
                font-weight: 500;
            `;
            
            // 添加动画样式
            if (!document.querySelector('#message-animations')) {
                const styleEl = document.createElement('style');
                styleEl.id = 'message-animations';
                styleEl.textContent = `
                    @keyframes messageSlideIn {
                        to { transform: translateX(0); opacity: 1; }
                    }
                    @keyframes messageSlideOut {
                        from { transform: translateX(0); opacity: 1; }
                        to { transform: translateX(100px); opacity: 0; }
                    }
                `;
                document.head.appendChild(styleEl);
            }
            
            document.body.appendChild(messageEl);
            
            // 自动移除消息
            setTimeout(() => {
                if (messageEl.parentNode) {
                    messageEl.remove();
                }
            }, duration + 500);
        }

        // 增强版粒子效果初始化
        function initParticles() {
            particlesCanvas = document.getElementById('particles-canvas');
            particlesCtx = particlesCanvas.getContext('2d');
            
            // 设置画布尺寸
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
            
            // 创建初始粒子
            createParticlesForSeason(currentSeason);
            
            // 开始动画
            animateParticles();
        }

        // 为季节创建粒子
        function createParticlesForSeason(season) {
            particles = [];
            
            // 季节粒子配置
            const seasonConfigs = {
                spring: {
                    count: 80,
                    colors: ['#2ecc71', '#27ae60', '#1abc9c', '#16a085'],
                    sizes: [2, 4, 6],
                    speeds: [0.5, 1, 1.5],
                    shapes: ['circle', 'leaf', 'petal'],
                    behaviors: ['float', 'swirl', 'bloom']
                },
                summer: {
                    count: 100,
                    colors: ['#e74c3c', '#c0392b', '#e67e22', '#d35400'],
                    sizes: [1, 3, 5],
                    speeds: [1, 2, 3],
                    shapes: ['circle', 'spark', 'flame'],
                    behaviors: ['rise', 'flicker', 'dance']
                },
                autumn: {
                    count: 70,
                    colors: ['#f39c12', '#d35400', '#e67e22', '#a35200'],
                    sizes: [3, 5, 7],
                    speeds: [0.3, 0.7, 1.2],
                    shapes: ['circle', 'leaf', 'seed'],
                    behaviors: ['fall', 'drift', 'twirl']
                },
                winter: {
                    count: 120,
                    colors: ['#3498db', '#2980b9', '#5dade2', '#85c1e9'],
                    sizes: [1, 2, 3, 4],
                    speeds: [0.2, 0.5, 0.8, 1.2],
                    shapes: ['circle', 'snowflake', 'crystal'],
                    behaviors: ['fall', 'swirl', 'glitter']
                },
                all: {
                    count: 90,
                    colors: ['#9b59b6', '#8e44ad', '#3498db', '#2ecc71', '#e74c3c', '#f39c12'],
                    sizes: [2, 4, 6],
                    speeds: [0.5, 1, 1.5],
                    shapes: ['circle', 'star', 'orb'],
                    behaviors: ['float', 'orbit', 'pulse']
                }
            };
            
            const config = seasonConfigs[season] || seasonConfigs.spring;
            
            for (let i = 0; i < config.count; i++) {
                particles.push({
                    x: Math.random() * particlesCanvas.width,
                    y: Math.random() * particlesCanvas.height,
                    size: config.sizes[Math.floor(Math.random() * config.sizes.length)],
                    color: config.colors[Math.floor(Math.random() * config.colors.length)],
                    speed: config.speeds[Math.floor(Math.random() * config.speeds.length)],
                    direction: Math.random() * Math.PI * 2,
                    shape: config.shapes[Math.floor(Math.random() * config.shapes.length)],
                    behavior: config.behaviors[Math.floor(Math.random() * config.behaviors.length)],
                    opacity: Math.random() * 0.6 + 0.4,
                    rotation: Math.random() * Math.PI * 2,
                    rotationSpeed: (Math.random() - 0.5) * 0.05,
                    wobble: Math.random() * 0.5,
                    wobbleSpeed: Math.random() * 0.05,
                    life: 1,
                    pulseSpeed: Math.random() * 0.02 + 0.01
                });
            }
        }

        // 动画粒子
        function animateParticles() {
            // 清除画布
            particlesCtx.clearRect(0, 0, particlesCanvas.width, particlesCanvas.height);
            
            // 绘制半透明背景层
            particlesCtx.fillStyle = 'rgba(10, 14, 23, 0.1)';
            particlesCtx.fillRect(0, 0, particlesCanvas.width, particlesCanvas.height);
            
            // 更新和绘制每个粒子
            particles.forEach(particle => {
                // 根据行为更新粒子位置
                updateParticlePosition(particle);
                
                // 确保粒子在画布范围内
                if (particle.x < -particle.size) particle.x = particlesCanvas.width + particle.size;
                if (particle.x > particlesCanvas.width + particle.size) particle.x = -particle.size;
                if (particle.y < -particle.size) particle.y = particlesCanvas.height + particle.size;
                if (particle.y > particlesCanvas.height + particle.size) particle.y = -particle.size;
                
                // 绘制粒子
                drawParticle(particle);
            });
            
            particleAnimationId = requestAnimationFrame(animateParticles);
        }

        // 绘制粒子
        function drawParticle(particle) {
            particlesCtx.save();
            particlesCtx.globalAlpha = particle.opacity;
            particlesCtx.fillStyle = particle.color;
            
            const size = particle.size * (particle.behavior === 'pulse' ? particle.life : 1);
            
            switch (particle.shape) {
                case 'circle':
                    particlesCtx.beginPath();
                    particlesCtx.arc(particle.x, particle.y, size, 0, Math.PI * 2);
                    particlesCtx.fill();
                    break;
                    
                case 'leaf':
                    particlesCtx.save();
                    particlesCtx.translate(particle.x, particle.y);
                    particlesCtx.rotate(particle.rotation);
                    
                    particlesCtx.beginPath();
                    particlesCtx.ellipse(0, 0, size * 1.5, size, 0, 0, Math.PI * 2);
                    particlesCtx.fill();
                    
                    particlesCtx.restore();
                    break;
                    
                default:
                    // 默认画圆
                    particlesCtx.beginPath();
                    particlesCtx.arc(particle.x, particle.y, size, 0, Math.PI * 2);
                    particlesCtx.fill();
                    break;
            }
            
            particlesCtx.restore();
        }

        // 更新粒子位置
        function updateParticlePosition(particle) {
            switch (particle.behavior) {
                case 'float':
                    particle.x += Math.cos(particle.direction) * particle.speed * 0.3;
                    particle.y += Math.sin(particle.direction) * particle.speed * 0.3;
                    particle.direction += (Math.random() - 0.5) * 0.1;
                    break;
                    
                case 'swirl':
                    particle.rotation += particle.rotationSpeed;
                    particle.x += Math.cos(particle.rotation) * particle.speed;
                    particle.y += Math.sin(particle.rotation) * particle.speed;
                    break;
                    
                case 'rise':
                    particle.y -= particle.speed;
                    particle.x += Math.sin(particle.y * 0.01) * 0.5;
                    break;
                    
                case 'fall':
                    particle.y += particle.speed;
                    particle.x += Math.sin(particle.y * 0.01) * 0.5;
                    break;
                    
                case 'pulse':
                    particle.life += particle.pulseSpeed;
                    if (particle.life > 1.2 || particle.life < 0.8) {
                        particle.pulseSpeed *= -1;
                    }
                    break;
                    
                default:
                    // 默认浮动行为
                    particle.x += Math.cos(particle.direction) * particle.speed * 0.2;
                    particle.y += Math.sin(particle.direction) * particle.speed * 0.2;
                    break;
            }
            
            particle.wobble += particle.wobbleSpeed;
        }

        // 更新粒子效果
        function updateParticlesForSeason(season) {
            // 停止当前动画
            if (particleAnimationId) {
                cancelAnimationFrame(particleAnimationId);
            }
            
            // 创建新季节的粒子
            createParticlesForSeason(season);
            
            // 重新开始动画
            animateParticles();
        }

        // 调整画布大小
        function resizeCanvas() {
            particlesCanvas.width = window.innerWidth;
            particlesCanvas.height = window.innerHeight;
        }

        // 设置键盘快捷键
        function setupKeyboardShortcuts() {
            document.addEventListener('keydown', (e) => {
                // Ctrl + O 打开文件选择
                if (e.ctrlKey && e.key === 'o') {
                    e.preventDefault();
                    document.getElementById('add-new-btn').click();
                }
                
                // Ctrl + F 打开文件夹导入
                if (e.ctrlKey && e.key === 'f') {
                    e.preventDefault();
                    document.getElementById('import-folder-btn').click();
                }
                
                // Delete 键删除选中图片
                if (e.key === 'Delete' && selectedImageId) {
                    const image = imageData.find(img => img.id === selectedImageId);
                    if (image && image.type === 'user') {
                        if (confirm(`确定要删除"${image.title}"吗？`)) {
                            deleteImage(selectedImageId);
                        }
                    }
                }
                
                // Esc 键取消操作
                if (e.key === 'Escape') {
                    hideAllForms();
                    exitEditMode();
                }
            });
        }

        // 页面卸载前清理
        window.addEventListener('beforeunload', function() {
            // 释放所有图片URL
            imageData.forEach(img => {
                if (img.url && img.url.startsWith('blob:')) {
                    URL.revokeObjectURL(img.url);
                }
            });
            
            if (newImageUrl) {
                URL.revokeObjectURL(newImageUrl);
            }
            
            // 停止粒子动画
            if (particleAnimationId) {
                cancelAnimationFrame(particleAnimationId);
            }
            
            // 保存数据
            saveToLocalStorage();
        });

        // 响应式调整
        window.addEventListener('resize', function() {
            resizeCanvas();
        });

        // 显示系统信息
        console.log(`
        ███████╗██╗████████╗███████╗██╗  ██╗██╗
        ██╔════╝██║╚══██╔══╝██╔════╝╚██╗██╔╝██║
        ███████╗██║   ██║   ███████╗ ╚███╔╝ ██║
        ╚════██║██║   ██║   ╚════██║ ██╔██╗ ██║
        ███████║██║   ██║   ███████║██╔╝ ██╗██║
        ╚══════╝╚═╝   ╚═╝   ╚══════╝╚═╝  ╚═╝╚═╝
        
        四时巡游·神话视觉转化系统 v2.0 - 完整修复版
        时序之神 · 系统化视觉转译工程
        --------------------------------------
        功能特色：
        1. 完整的本地文件导入系统
        2. 拖放上传支持（单文件/多文件/文件夹）
        3. 自定义图片介绍编辑
        4. 本地数据存储和自动保存
        5. 数据导出/导入功能
        6. 增强的视觉效果和动画
        --------------------------------------
        设计理念：将神话文献转化为视觉语言
        创作团队：时序之神视觉研究组
        `);
    </script>
</body>
</html>
